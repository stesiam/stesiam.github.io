---
title: "Περιγραφική Ανάλυση Ελληνικού Κοινοβουλίου"
author: "stesiam"
lang: el
description: |
  Μία βασική ανάλυση των διατελέσαντων βουλευτών της περιόδου (1981 - 2019)
freeze: false
link-external-newwindow: true
categories: [R, Περιγραφικη αναλυση]
image: images/houses-of-parliament.png
image-alt: "Πρόσοψη κτιρίου Ελληνικού Κοινοβουλίου"
fig-cap-location: bottom
date: "2022-10-10"
toc: true
toc-title: Περιεχόμενα
toc-location: left
citation: true
title-block-banner: true
nocite: '@*'
csl: apa-6th-edition.csl
bibliography: [packages.bib, references.bib]
format: 
  html:
    freeze: false
    code-link: true
    code-fold: true
    embed-resources: false
    lib-dir: site_libs
    code-summary: "Δείξε τον κώδικα"
    code-tools: 
      source: https://github.com/stesiam/stesiam.github.io/blob/gh-pages/posts/eda-greek-parliament/index.el.qmd
execute:
  echo: true
editor_options: 
  markdown: 
    wrap: 80
---

## Εισαγωγή

Και ξεκινάμε...

Αυτό είναι το πρώτο άρθρο ανάλυσης στην ιστοσελίδα μου! Προσωπικά, δεν επιθυμούσα να ξεκινήσω με μία έτοιμη βάση δεδομένων και να εφαρμόσω ένα απλό μοντέλο μηχανικής μάθησης (ενδεχομένως να το κάνω σε ένα επόμενο άρθρο). Αποφάσισα να παιδευτώ ελαφρώς προκειμένου να εφαρμόσω όλο τον κύκλο της ανάλυσης δεδομένων ξεκινώντας από την εξόρυξη αυτών, στη τακτοποίηση και να καταλήξω στην ανάλυσή τους. Σε αυτό το άρθρο θα ήθελα να ασχοληθώ με την ιστορία των εκπροσώπων του ελληνικού κοινοβουλίου και να απαντηθούν κάποια ενδιαφέροντα ερωτήματα. Για τη διεξαγωγή της έρευνας θα εξάγω τα δεδομένα που έχει δημοσιεύσει η [ιστοσελίδα του Ελληνικού Κοινοβουλίου](hellenicparliament.gr/) σχετικά με τους εκλεγμένους βουλευτές.

Το ελληνικό πολιτικό σκηνικό έχει κατακτήσει την συζήτηση της κοινούς γνώμης τα τελευταία χρόνια, για τους λάθος λόγους, λόγω της πρόσφατης οικονομικής κρίσης. Ένα σημαντικό μέρος του διαλόγου είναι τα αίτια της κρίσης, όπου αυτά είναι πολλά και αποτελούν σημείο αντιπαράθεσης μέχρι και σήμερα. Σε αυτό το άρθρο θα ασχοληθώ με μόνο ένα σημείο της κριτικής, ότι <<έχουμε τους ίδιους>> εκπροσώπους. Βέβαια οι εκπρόσωποι μας στη Βουλή δεν ορίστηκαν από κανένα κόμμα, άλλά αντιθέτως έγιναν εκλογές, οπότε η κριτική ρίχνει μεγάλο μέρος να μην εκλέγει άλλο κόμμα ή εκπροσώπους ενδεχομένως λόγω προσωπικών οφελών. Τελικά, τι συνέβη σε αυτή τη περίπτωση; Είναι ένας ισχυρισμός που έχει νόημα; Αυτό θα μελετήσω σε αυτό το άρθρο, όμως παράλληλα θα μελετήσω την εμμονή σε ίδια πρόσωπα σε οπαδούς του ίδιου κόμματος, ενώ παρουσιάζει ενδιαφέρον η μελέτη του ίδιου χαρακτηριστικού σε επίπεδου νομού.

## Προαπαιτούμενα

### Εισαγωγή πακέτων

Αρχικά θα εισάγουμε τις απαραίτητες βιβλιοθήκες, αναλόγως των εντολών που χρειάζομαι και της ανάλυσης που θα κάνω. Ενδεικτικά θα χρειαστώ το μετα-πακέτο `{tidyverse}` για να εισάγω, τροποποιήσω και οπτικοποιήσω τα δεδομένα. Στη συνέχεια, για τη κατασκευή πινάκων θα χρησιμοποιήσω το πακέτο `{reactable}`. Τέλος, για να έχω διαγράμματα που να φαίνονται αξιοπρεπώς σε όλους τους τύπους των οθονών προτείνεται η χρήση του πακέτου `{highcharter}`.

```{r}
#| label: import_r_libs
#| title: "Εισαγωγή βιβλιοθηκών"
#| message: false
#| results: hide
#| warning: false

library(arrow)
# General purpose R libraries
library(tidyverse)
library(kableExtra)
library(reactable)
library(keyring)
library(deeplr)
library(gt)

# Graphs
library(ggplot2)
library(ggpol) 
library(ggtext)
library(highcharter)

# Άλλες ρυθμίσεις
options(digits=2) # print only 2 decimals
```

```{r}
#| label: add_bib_records_from_rpackages
#| include: false

knitr::write_bib(.packages(), file = 'packages.bib')
```

### Εισαγωγή δεδομένων

Για να βρω ποιοι είναι οι περισσότεροι εκλεγμένοι βουλευτές σε εθνικό επίπεδο, κόμματος αλλά και εκλογικής περιφέρειας πρέπει να βρω τα  αντίστοιχα δεδομένα. Ευτυχώς, η ιστοσελίδα του Ελληνικού Κοινοβουλίου διατηρεί σχετικό ηλεκτρονικό αρχείο με τους εκλεγμένους βουλευτές από το 1974 μέχρι και το 2019. Τα δεδομένα εξορύχθηκαν με τη βοήθεια του πακέτου `{RSelenium}`, ωστόσο δεν θα αναλύσω τον τρόπο αυτού. Σε περίπτωση που κάποιος ενδιαφέρεται για αυτό μπορεί να δει το σχετικό κώδικα στο GitHub. Χρησιμοποιώ έτοιμο το εξορυγμένο σύνολο δεδομένων και το εισάγω με την εντολή read_csv.

```{r}
#| label: import_dataset
#| message: false
parliamentGR = read.csv("https://github.com/stesiam/scrape-greek-parl-members-26/releases/download/v1.1.0/parlMembers-el.csv")
parliamentEN = read.csv("https://github.com/stesiam/scrape-greek-parl-members-26/releases/download/v1.1.0/parlMembers-eng.csv")
```


### Ορισμός συναρτήσεων

Προκειμένου να αποφύγω την επανάληψη του κώδικά μου θα ορίσω και μερικές
συναρτήσεις. Αρχικά, θέλω να έχω πίνακες που βασίζονται στη βιβλιοθήκη
`{reactable}` με ορισμένες αλλαγές στην εμφάνιση για να φαίνονται ωραία. Για αυτό
σε πολλούς πίνακες θα δείτε χρήση της `reactable_custom` αντί απλώς της
`reactable` εντολής.

```{r}
#| label: function_reactable_tables
gt_custom <- function(data, head_max = 5) {
  data_subset <- as.data.frame(data) %>% head(head_max)
  
  data_subset %>%
    gt() %>%
    # 1. Internal GT Alignment
    cols_align(align = "center", columns = everything()) %>%
    
    # 2. Typography
    tab_style(
      style = cell_text(v_align = "middle", weight = "bold", whitespace = "normal"),
      locations = cells_column_labels()
    ) %>%
    # 3. THEME & COLORS
    tab_options(
      row.striping.include_table_body = FALSE,
      table.background.color = "transparent",
      column_labels.background.color = "transparent",
      table.width = pct(100), 
      table.font.size = px(13),           
      data_row.padding = px(15), 
      column_labels.padding = px(15),
      
      # Borders
      table.border.top.style = "none",
      table.border.bottom.style = "none",
      table_body.hlines.style = "none", 
      column_labels.border.top.width = px(2),
      column_labels.border.top.color = "#757575",
      column_labels.border.bottom.width = px(2),
      column_labels.border.bottom.color = "#757575",
      table_body.border.bottom.width = px(2),
      table_body.border.bottom.color = "#757575"
    ) %>%
    
    # 4. CSS FOR SUB-PLOT CENTERING
    opt_css(css = "
      /* Force every cell (header and body) to center text */
      .gt_table th, .gt_table td { 
        text-align: center !important; 
        vertical-align: middle !important;
      }
      
      /* Force the table to center within the Quarto column */
      .gt_table { 
        margin-left: auto !important; 
        margin-right: auto !important; 
        width: 100% !important;
      }
      
      /* Strip row backgrounds */
      .gt_table tr { background-color: transparent !important; }
      .gt_row { background-color: transparent !important; }
    ") %>%
    cols_label_with(
      fn = function(x) {
        html(paste0(
          "<b>", greek_labels[x], "</b>",
          "<br><span style='font-size:10px; color:#777; font-style:italic;'>",
          x,
          "</span>"
        ))
      }
  )
}
reactable_custom = function(data, head_max = 5){
  reactable(
  head(data, head_max),
  bordered = FALSE,     # No borders (booktabs style)
  striped = FALSE,      # No stripes for a clean look
  highlight = FALSE,    # No hover highlighting
  defaultColDef = colDef(align = "center"),
  style = list(fontSize = "14px", border = "none"),
  theme = reactableTheme(
    borderColor = "transparent", # Remove border
    cellStyle = list(
      borderBottom = "transparent"  # Subtle line between rows
    ),
    headerStyle = list(
      borderBottom = "2px solid rgb(117, 117, 117)", # Thick top rule
      borderTop = "2px solid rgb(117, 117, 117)",
      fontWeight = "bold"
    )
  )
) 
}
```

Αυτό το άρθρο είναι ένα άρθρο ανάλυσης του κοινοβουλίου. Θα ήταν εξαιρετικά ενδιαφέρον μιας και υπάρχουν δεδομένα των βουλευτών και των κοινοβουλευτικών ομάδων που ανήκουν να κατασκευάσω διαγράμματα Βουλής. Με δεδομένο ότι κάνω ιστορική αναδρομή είναι πολύ πιθανό να χρειαστώ παραπάνω από τρία στο συγκεκριμένο άρθρο, γεγονός που δικαιολογεί τη δημιουργία μίας συνάρτησης. Η συνάρτηση μου θα καλείται `plot_parliament_term` και θα δέχεται ουσιαστικά ως τιμή έναν αριθμό που θα δηλώνει ποιας περιόδου της βουλή θα θέλαμε να διαγραμμαστίσουμε. Τα δεδομένα μου έχουν διαθέσιμα δεδομένα από τη Γ - 3η περίοδο (1981 - 1985) μέχρι και την ΙΗ' (17) περίοδο (2019Β- ), συνεπώς το όρισμα της συνάρτησης δέχεται τιμές από το 3 μέχρι το 17. 

```{r}
plot_parliament_term <- function(term_num, parliament_data = clean_dataset, parties_data = parties) {
  # Filter the parliament data for the selected term and summarize by party
  term_data <- parliament_data |>
    dplyr::filter(Term == term_num) |>
    group_by(partyAbbrNamesGR) |>
    summarise(n = n()) |>
    ungroup() 

  # Perform fuzzy join with parties data based on party name similarity
  term_data_joined <- fuzzyjoin::stringdist_inner_join(term_data, parties_data, by = "partyAbbrNamesGR",
                                                      max_dist = 2, distance_col = "distance") |>
    group_by(partyAbbrNamesGR.x) |>
    slice_min(distance) |>   # Ensure only the closest match is selected
    rename(Party = partyAbbrNamesGR.x) |>
    distinct() %>%
    ungroup() %>%
    select(Party, partyFullNamesGR, n, Color) |>
    distinct()
  
    title_text = "Κατανομή θέσεων"
    subtitle_text = "Τελική μορφή Ελληνικού Κοινοβουλίου"
    caption_text = '<b>Πηγή:</b> Ελληνικό Κοινοβούλιο | <b>Γράφημα:</b> <a href="https://stesiam.com/" target="_blank">stesiam.com</a> '
    hover_text = "Βουλευτές"


  # Conditionally adjust the data based on language
  # if (lang == "en") {
  #   term_data_joined <- select(term_data_joined, names, Party, n, Color)
  #   title_text = "Distribution of seats"
  #   subtitle_text = "Final formation of Hellenic Parliament"
  #   caption_text = '<b>Source:</b> Hellenic Parliament | <b>Graphic:</b> <a href="https://stesiam.com/" target="_blank">stesiam.com</a>'
  #   hover_text = "Representatives"
  # } else {
  #   term_data_joined <- select(term_data_joined, names_el, Party_el, n, Color)
  #   title_text = "Κατανομή θέσεων"
  #   subtitle_text = "Τελική μορφή Ελληνικού Κοινοβουλίου"
  #   caption_text = '<b>Πηγή:</b> Ελληνικό Κοινοβούλιο | <b>Γράφημα:</b> <a href="https://stesiam.com/" target="_blank">stesiam.com</a> '
  #   hover_text = "Βουλευτές"
  # }
    
  # Create the highcharter plot for the specific term
  highchart() %>%
    hc_chart(type = 'item') %>%
    hc_title(text = title_text) %>%
    hc_subtitle(text = subtitle_text) %>%
    hc_caption(
      text = caption_text,
      align = 'center',
      verticalAlign = 'bottom',
      y = 10
    ) %>%
    hc_legend(labelFormat = '{name} <span style="opacity: 0.4">{y}</span>') %>%
    hc_add_series(
      name = hover_text,
      data = purrr::pmap(
          list(term_data_joined$partyFullNamesGR, term_data_joined$n, term_data_joined$Color, term_data_joined$Party),
        list
      ),
      keys = c("name", "y", "color", "label"),
      dataLabels = list(
        enabled = TRUE,
        format = "{point.label}",
        style = list(textOutline = "5px contrast")
      ),
      center = list("50%", "50%"),
      size = "100%",
      startAngle = -150,
      endAngle = 150
    ) %>%
    hc_responsive(
      rules = list(
        list(
          condition = list(maxWidth = 600),
          chartOptions = list(
            series = list(
              list(dataLabels = list(distance = -30))
            )
          )
        )
      )
    )
}
```


```{r}
##new function plot
plot_parliament <- function(data, period_number) {
    
    df_period <- data %>%
        filter(period_num == period_number)
    
    seats_party <- df_period %>%
        group_by(abbrNamesEl, fullNamesEl, Color) %>%
        summarise(seats = n(), .groups = "drop") %>%
        arrange(desc(seats))
    
    highchart() %>%
        
        hc_chart(type = "item") %>%
        
        hc_title(text = paste0("Σύνθεση Βουλής – Περίοδος ", period_number)) %>%
        
        hc_add_series(
            type = "item",
            name = "Έδρες",
            layout = "parliament",
            startAngle = -110,
            endAngle = 110,
            keys = c("name", "y", "color", "full_name"),
            data = seats_party %>%
                transmute(
                    name = abbrNamesEl,
                    y = seats,
                    color = Color,
                    full_name = fullNamesEl
                ) %>%
                list_parse(),
            
            dataLabels = list(
                enabled = TRUE,
                format = "{point.name}",
                distance = 35,
                crop = FALSE,
                overflow = "none",
                backgroundColor = "rgba(255,255,255,0.95)",
                borderColor = "#dddddd",
                borderWidth = 1,
                borderRadius = 6,
                padding = 3,
                style = list(
                    fontWeight = "bold",
                    fontSize = "12px",
                    textOutline = "none"
                )
            )
        ) %>%
        
        hc_tooltip(
            useHTML = TRUE,
            formatter = JS("
        function () {
          return '<b>' + this.point.full_name + '</b><br>' +
                 'Έδρες: ' + this.point.y;
        }
      ")
        ) %>%
        
        hc_legend(enabled = FALSE) %>%
        hc_credits(enabled = FALSE) %>%
        
        hc_responsive(
            rules = list(
                list(
                    condition = list(maxWidth = 600),
                    chartOptions = list(
                        legend = list(
                            enabled = TRUE,
                            align = "center",
                            verticalAlign = "bottom",
                            layout = "horizontal"
                        ),
                        plotOptions = list(
                            item = list(
                                startAngle = -100,
                                endAngle = 100,
                                dataLabels = list(
                                    enabled = FALSE  # hide labels on mobile
                                )
                            )
                        )
                    )
                )
            )
        )
}
```

### Δομή δεδομένων

Με βάση τον παραπάνω πίνακα τα συλλεγμένα δεδομένα αποτελούνται από `r ncol(parliament)` μεταβλητές (στήλες), εκ των οποίων καμία δεν είναι ποσοτική και οι υπόλοιπες τέσσερις. Από αυτές τις τέσσερις, οι τρεις είναι κατηγορικές και άλλη μία που είναι μία διατάξιμη μεταβλητή.

::: {.table-responsive}
|    Μεταβλητή    |           Τύπος μεταβλητής           |                 Περιγραφή                  |
|:----------------:|:----------------------:|:------------------------------------:|
|  `Full Name`   | *Ποιοτική* <br> (κατηγορική) | Επώνυμο / Όνομα / Όνομα πατέρα |
|    `Party`     | *Ποιοτική* <br> (κατηγορική) |    Κοινοβουλευτική όμάδα - Κόμμα που εκπροσωπεί     |
| `Constituency` | *Ποιοτική* <br> (κατηγορική) |       Εκλογική περιφέρεια          |
|     `Term`     | *Ποιοτική* <br> (διατάξιμη) |                 Περίοδος θητείας                 |
|     `gender`     | *Ποιοτική* <br> (διατάξιμη) |                Εκτίμηση κοινωνικού φύλου με βάση το όνομα    |
: Σύνοψη και περιγραφή μεταβλητών {#tbl-describe-vars}
:::

Αυτή η σύνοψη των δεδομένων είναι σημαντική, αλλά τις περισσότερες φορές είναι ωφέλιμη η προεπισκόπηση αυτών. Έτσι λοιπόν θα επιλέξω να εκτυπώσω και τις πρώτες γραμμές του συνόλου δεδομένων μου.

```{r}
#| echo: false
greek_labels <- c(
    name = "Ονοματεπώνυμο",
    party = "Κόμμα",
    region = "Περιφέρεια",
    period_name = "Εκλογική περίοδος",
    dates = "Διάρκεια περιόδου",
    gender = "Εκτιμώμενο φύλο"
)
```


```{r Preview Data}
#| label: tbl-preview-dataset
#| tbl-cap: "Προεπισκόπηση συνόλου δεδομένων (πρώτες 10 σειρές)"
#| echo: false

preview_dataset = gt_custom(parliamentGR, 10)
preview_dataset
```

## Τακτοποίηση δεδομένων

Αφότου εισάγω τα δεδομένα καλό θα ήταν να γίνει κάποια βασική τακτοποίηση αυτών ή μία εκτεταμένη μορφή αυτής σε περίπτωση που διαπιστώσω ότι τα δεδομένα μου δεν έχουν οργανωμένη ή μία συνεπή δομή. Θα μελετήσουμε σταδιακά τη κάθε μεταβλητή, ξεκινώντας από τα ονόματα των κομμάτων (μεταβλητή `Party`). Αρχικά, ας συλλέξουμε όλα τις πιθανές τιμές, δηλαδή όλες τις κοινοβουλευτικές ομάδες στην ιστορία του κοινοβουλίου που δεν διαλύθηκαν προτού γίνουν νέες εκλογές. Τα ονόματα των κομμάτων είναι στα αγγλικά και οι εκτάσεις των ονομάτων εξαιρετικά μεγάλες, ενώ αναμιγνύονται τα ονόματα με τις συντμήσεις των ονομάτων τους. 

::: {.column-margin}
![](images/houses-of-parliament.png)
Η πρόσοψη του Ελληνικού Κοινοβουλίου που βρίσκεται στη πλατεία Συντάγματος. Η κατασκευή του κτιρίου ξεκίνησε το 1836 και ολοκληρώθηκε το 1843. Ο αρχικός σκοπός του κτιρίου να είναι ανάκτορο για τον βασιλιά Όθωνα για αυτό το λόγο το κτίριο είναι γνωστό και με το όνομα Παλαιά Ανάκτορα. Από το 1935 μέχρι και σήμερα χρησιμοποιείται ως έδρα του κοινοβουλίου.
<br>
**Πηγή φωτογραφίας:** Pixabay, 2022 από το χρήστη [Leonhard_Niederwimmer](https://pixabay.com/photos/houses-of-parliament-greece-athens-7402132/) - **Άδεια χρήσης:** [Pixabay Licence](https://pixabay.com/service/terms/)
:::

```{r}
#| label: tbl-preview_party_names_raw
#| tbl-cap: "Προεπισκόπηση ονομάτων κομμάτων Ελληνικού Κοινοβουλίου"
data.frame(
   "Κόμμα"= unique(parliamentGR$party),
   "Σύνολο χαρακτήρων" = str_length(unique(parliamentGR$party)),check.names = FALSE
) %>%
  arrange(-`Σύνολο χαρακτήρων`) %>%
  gt_custom(., 7)
```

Σαν να μην έφτανε αυτό παρατηρώ ότι υπάρχουν πολλαπλές καταχωρήσεις για το ίδιο κόμμα που ενδεχομένως κατά τη πάροδο των ετών έκανε ένα μικρό rebranding (Ανεξάρτητοι Έλληνες) ή ακόμα και πιο μεγάλες αλλαγές που κατά βάση αναφέρονται και είναι πρόγονοι ή απόγονοι ως επί το πλείστον του ίδιου κόμματος (Συνασπισμός -> ΣΥΡΙΖΑ ή ΠΑΣΟΚ -> Ελιά -> Δημοκρατική Συμπαράταξη -> Κίνημα Αλλαγής -> ΠΑΣΟΚ). Μιας και αυτές οι αλλαγές δεν μπορούν να κατανοηθούν εύκολα,  κρίνεται απαραίτητη η δημιουργία ενός νέου πίνακα ώστε να ομαδοποιήσω αυτή τη πληροφορία και να την συγχωνεύσω στο βασικό μου σύνολο δεδομένων. 

```{r}
#| echo: false
greek_labels <- c(
    sourceNamesEL = "Όνομα κόμματος (αρχικό)",
    fullNamesEn = "Όνομα κόμματος (αγγλ. πλήρες)",
    fullNamesEl = "Όνομα κόμματος (ελλ. πλήρες)",
    abbrNamesEn = "Συντομογραφία (ελλ.)",
    abbrNamesEl = "Συντομογραφία (αγγλ.)",
    Color = "Χρώμα"
)
```

```{r}
#| label: tbl-organize-party-names
#| tbl-cap: "Οργάνωση ονομάτων κομμάτων και συντμήσεών τους"
parties = data.frame(
  sourceNamesEL = unique(parliamentGR$party),
  fullNamesEn = c("New Democracy","Coalition of the Radical Left", "Panhellenic Socialistic Movement",
                       "Communist Party of Greece", "Independent", "Greek Solution", 
                       "Coalition of the Radical Left", "Panhellenic Socialistic Movement", 
                       "European Realistic Disobedience Front", "Golden Dawn", 
                       "Panhellenic Socialistic Movement", "The River", "Popular Unity",
                       "Independent Greeks", "Panhellenic Socialistic Movement",
                       "Independent Greeks", "Democratic Left", "Independent Democratic MPs",
                       "Popular Orthodox Rally", "Coalition of the Radical Left",
                       "Democratic Social Movement", "Political Spring", "Alternative Ecologists",
                       "Democratic Renewal", "Communist Party οf Greece (interior)",
                       "Union of the Democratic Centre","National Alignment", 
                       "Progress and Left Forces Alliance", "Party of New Liberals", "United Democratic Left"),
  fullNamesEl = c("Νέα Δημοκρατία", "Συνασπισμός Ριζοσπαστικής Αριστεράς", "Πανελλήνιο Σοσιαλιστικό Κίνημα",
                       "Κομμουνιστικό Κόμμα Ελλάδας", "Ανεξάρτητοι", "Ελληνική Λύση",
                       "Συνασπισμός Ριζοσπαστικής Αριστεράς", "Πανελλήνιο Σοσιαλιστικό Κίνημα",
                       "Μέτωπο Ευρωπαϊκής Ρεαλιστικής Ανυπακοής", "Χρυσή Αυγή",
                       "Πανελλήνιο Σοσιαλιστικό Κίνημα", "Το Ποτάμι", "Λαϊκή Ενότητα",
                       "Ανεξάρτητοι Έλληνες", "Πανελλήνιο Σοσιαλιστικό Κίνημα",
                        "Ανεξάρτητοι Έλληνες", "Δημοκρατική Αριστερά", "Ανεξάρτητοι Δημοκρατικοί Βουλευτές",
                       "Λαϊκός Ορθόδοξος Συναγερμός", "Συνασπισμός Ριζοσπαστικής Αριστεράς",
                       "Δημοκρατικό Κοινωνικό Κίνημα", "Πολιτική Άνοιξη", "Εναλλακτικοί Οικολόγοι",
                       "Δημοκρατική Ανανέωση", "Κομμουνιστικό Κόμμα Ελλάδας Εσωτερικού", 
                       "Ένωση Δημοκρατικού Κέντρου", "Εθνική Παράταξη", 
                       "Συμμαχία Προοδευτικών και Αριστερών Δυνάμεων", "Κόμμα Νεοφιλελευθέρων", 
                       "Ενιαία Δημοκρατική Αριστερά"),
  abbrNamesEn = c("ND", "SYRIZA", "PASOK", "KKE", "Independent", "Lysi", "SYRIZA", "PASOK",
                       "MeRA25", "GD", "PASOK", "River", "LaE", "ANEL", "PASOK", "ANEL", "DIMAR",
                       "ADP", "LAOS", "SYRIZA", "DIKKI", "POLAN", "AE", "DIANA", "KKE int.",
                       "EDIK", "EP", "SPAD", "KNF", "EDA"),
    abbrNamesEl = c("ΝΔ", "ΣΥΡΙΖΑ", "ΠΑΣΟΚ", "ΚΚΕ", "Ανεξάρτητοι", "Λύση", "ΣΥΡΙΖΑ", "ΠΑΣΟΚ",
                       "ΜέΡΑ25", "ΧΑ", "ΠΑΣΟΚ", "ΠΟΤΑΜΙ", "ΛΑΕ", "ΑΝΕΛ", "ΠΑΣΟΚ", "ΑΝΕΛ", "ΔΗΜΑΡ",
                       "ΑΔΠ", "ΛΑΟΣ", "ΣΥΡΙΖΑ", "ΔΗΚΚΙ", "ΠΟΛΑΝ", "ΑΕ", "ΔΗΑΝΑ", "ΚΚΕ εσ.",
                       "ΕΔΗΚ", "ΕΠ", "ΣΠΑΔ", "ΚΝΦ", "ΕΔΑ")) |>
  mutate(Color = case_when(
    abbrNamesEn == "PASOK" ~ "#95bb72",
    abbrNamesEn == "ND" ~ "#0492c2",
    abbrNamesEn == "KKE" ~ "#FF6666",
    abbrNamesEn == "SYRIZA" ~ "#e27bb1",
    abbrNamesEn == "KKE int." ~ "#FF3366",
    abbrNamesEn == "INDEPENDENT" ~ "#ffffff",
    abbrNamesEn == "DIANA" ~ "orange",
    abbrNamesEn == "DHMAR" ~ "#FF4466",
    abbrNamesEn == "RIVER" ~ "#5592aa",
    TRUE ~ "#808080"
  ))

parties %>% gt_custom()
```

Πλέον είμαι σε θέση να χρησιμοποιήσω την ελληνική ή την αγγλική έκδοση των ονομάτων των κομμάτων, ενώ σε περίπτωση δημιουργίας ενός γραφήματος έχω αντιστοιχίσει την πιο κοινά αποδεκτή συντομογραφία τους. Τέλος, ο διαχωρισμός του πλήρους ονόματος και μιας συντομογραφίας είναι αρκετά σημαντική για τη δημιουργία γραφημάτων μιας και συνήθως ο διαθέσιμος χώρος είναι περιορισμένος και δίνουμε στον αναγνώστη τη πληροφορία που χρειάζεται δίχως να κουράζουμε, βελτιώνοντας την αναγνωσιμότητα και τη κατανόηση του. Όπως είδαμε και παραπάνω υπάρχουν ονόματα - σιδηρόδρομοι, όπως των Ανεξαρτήτων Ελλήνων, όπου αριθμεί 81 χαρακτήρες και της Δημοκρατικής Συμπαράταξης (στην ουσία ΠΑΣΟΚ, σε συνεργασία με μικρά κόμματα όπως η ΔΗΜΑΡ, ΚΙΔΗΣΟ κ.α.) με 70. Σε αντιπαραβολή αυτών των ονομάτων και για λόγους πληρότητας το ΠΟΛ.Α. ήταν το όνομα με τους λιγότερους χαρακτήρες (6) και αναφέρεται στο κόμμα Πολιτική Άνοιξη. Πριν κλείσω τη συγκεκριμένη ενότητα θα ήθελα να κάνω αναφορά στη τελευταία στήλη του πίνακα. Με τόσα κόμματα είναι εμφανές ότι θα χρειαστεί να θέσω χρώματα κατάλληλα για το καθένα, αλλά το πλήθος τους ίσως προκαλέσει σύγχυση σε ποιο αναφέρομαι. Έκρινα λοιπόν απαραίτητη αυτή τη προσθήκη με βάση τα χρώματα στο έμβλημα του κάθε κόμματος να επιλέξω το πιο αντιπροσωπευτικό, τουλάχιστον για τα πιο γνωστά.


Κάπου εδώ έκλεισε η ενότητα των κομμάτων και ανοίγει μία τελευταία πρόκληση. Αυτή των ονομάτων των βουλευτών. Στη προεπισκόπηση των δεδομένων τα ονόματα δίνονται με σχετικά συνεπή δομή. Συνήθως αποτελούνται από `Επώνυμο` `Όνομα` `Πατρώνυμο`. Βέβαια πολλές φορές υπάρχουν βουλευτές που έχουν δύο ονόματα ή δύο επίθετα. Σε αυτές τις περιπτώσεις διαχωρίζονται τα διπλά επώνυμα ή ονόματα με μία παύλα.

> Θα αναρωτηθεί κάποιος και το πρόβλημα που είναι; Αφού είναι απλά μία μεταβλητή με τα ονόματά τους.

Ναι! Αλλά μπορούμε να κάνουμε καλύτερη δουλειά επειδή σε αυτή τη μεταβλητή εσωκλείεται περισσότερη πληροφορία. Με λίγη προσπάθεια από μέρους μας μπορούμε να χωρίσουμε το όνομα σε άλλες τρεις μεταβλητές, όπου θα δηλώνουν το επίθετο του βουλευτή, το όνομά του και το πατρώνυμό του ξεχωριστά. Αυτό ενδέχεται να μας φανεί χρήσιμο σε τυχόν διαγράμματα όπου θα μπορούμε να αναφερόμαστε αποκλειστικά στο επίθετο και στο αρχικό του ονόματός του, αντί στο πλήρες όνομά του συμπεριλαμβανομένου και του πατρώνυμου.


```{r}
#| echo: false


greek_labels <- c(
    name = "Ονοματεπώνυμο βουλευτή",
    surname1 = "Πρώτο Επίθετο",
    surname2 = "Δεύτερο Επίθετο",
    name1 = "Πρώτο Όνομα",
    name2 = "Δεύτερο Όνομα",
    father_name = "Όνομα Πατρός",
    sourceNamesEL = "Όνομα Κόμματος (αρχικό)",
    fullNamesEl = "Πλήρες Όνομα Κόμματος (ελλ.)",
    abbrNamesEl = "Συντομογραφία Κόμματος (ελλ.)",
    fullNamesEn = "Πλήρες Όνομα Κόμματος (αγγλ.)",
    abbrNamesEn = "Συντομογραφία Κόμματος (αγγλ.)",
    region = "Περιφέρεια",
    period_name = "Περίοδος",
    period_num = "Αριθμός Περιόδου",
    dates = "Διάρκεια Περιόδου",
    gender = "Εκτιμώμενο φύλο",
    Color = "Χρώμα Κόμματος"

)
```

```{r}
#| label: tbl-clean-dataset
#| tbl-cap: "Επεξεργασμένο - τακτοποιημένο σύνολο δεδομένων"
pattern <- "^([^-\\s]+)(?:\\s*-\\s*([^-\\s]+))?\\s+([^-\\s]+)(?:\\s*-\\s*([^-\\s]+))?(?:\\s+([^-\\s]+(?:\\s*(?:-|\\s)\\s*[^-\\s]+)*))?$"

mps_clean_names = parliamentGR %>%
  mutate(
    name = name %>%
      str_remove_all("\\s*\\([^)]*\\)") %>%
      str_squish()
  ) %>%
  extract(
    name,
    into = c("surname1", "surname2", "name1", "name2", "father_name"),
    regex = pattern,
    remove = FALSE
  )|>
  mutate(
    surname1 = if_else(
      str_detect(name, "Ληναίος - Μητυλιναίος"),
      "Ληναίος",
      surname1
    ),
    name1 = if_else(
      str_detect(name, "Ληναίος - Μητυλιναίος"),
      "Διονύσιος",
      name1
    )
  ) |>
  mutate(
    surname1 = if_else(
      str_detect(name, "Κουίκ Τέρενς"),
      "Κουίκ",
      surname1
    ),
    name1 = if_else(
      str_detect(name, "Κουίκ Τέρενς"),
      "Τέρενς",
      name1
    )
  ) |>
  mutate(
    surname1 = if_else(
      str_detect(name, "Μπαλτάς Αριστείδης"),
      "Μπαλτάς",
      surname1
    ),
    name1 = if_else(
      str_detect(name, "Μπαλτάς Αριστείδης"),
      "Αριστείδης",
      name1
    )
  ) |>
  rename(sourceNamesEL = party)

mps_clean_names$period_num <- mps_clean_names$period_name |>
  fct_recode(
    "1" = "Α'",
    "2" = "Β'",
    "3" = "Γ'",
    "4" = "Δ'",
    "5" = "Ε'",
    "7" = "Ζ'",
    "8" = "Η'",
    "9" = "Θ΄",
    "10" = "Ι'",
    "11" = "ΙΑ'",
    "12" = "ΙΒ'",
    "13" = "ΙΓ΄",
    "14" = "ΙΔ΄",
    "15" = "ΙΕ΄",
    "17" = "ΙΖ΄",
    "18" = "ΙΗ΄",
    "19" = "ΙΘ΄",
    "16" = "ΙΣΤ΄",
    "6" = "ΣΤ'"
  ) |>
  as.character() |>
  as.numeric()

clean_dataset = mps_clean_names %>%
    left_join(parties, by = "sourceNamesEL") %>%
    relocate(fullNamesEl, .after = sourceNamesEL) %>%
    relocate(abbrNamesEl, .after = fullNamesEl) %>%
    relocate(fullNamesEn, .after = abbrNamesEl) %>%
    relocate(abbrNamesEn, .after = fullNamesEn) %>%
    relocate(period_num, .after = period_name)


clean_dataset %>% 
  gt_custom()
```


## Αριθμός κομμάτων

Έχοντας τακτοποιήσει τα δεδομένα μου, θα ξεκινήσω την ανάλυσή μου με μία ιστορική αναδρομή στον αριθμό των κομμάτων που έχουν εκπροσωπήσει το Ελληνικό κοινοβούλιο και έχουν ολοκληρώσει τη θητεία τους ως κοινοβουλευτική ομάδα. Από τη πτώση της χούντας τα κόμματα που εκπροσωπούσαν το κοινοβούλιο ήταν αρκετά λίγα, και είναι τα πλέον ιστορικά, το ΚΚΕ, η Νέα Δημοκρατία και το ΠΑΣΟΚ. Έτσι λοιπόν η βουλή του 1981, εκπροσωπούνταν μόλις από τρία κόμματα. 


```{r}
#| label: fig-parl-term-3
#| fig-cap: "Σύνθεση Ελληνικού Κοινοβουλίου Γ' περιόδου (1981 - 1985)"
plot_parliament(clean_dataset, 3)
```

Η ωρίμανση των συνθηκών της Μεταπολίτευσης έδωσε τη δυνατότητα σε εκφραστούν και άλλες απόψεις οι οποίες μετουσιώθηκαν σε νέα κόμματα. Μετά τη θητεία του '81-'85, στη Βουλή αρχίζουν να εμφανίζονται νέες δυνάμεις με μικρά ποσοστά. Πιο σημαντική σε αριθμό εδρών είναι αυτή του Συνασπισμού (Σύριζα), όπου είχε και μακρά παρουσία στη Βουλή, ωστόσο αρκετά μικρή και επισφαλή εκπροσώπηση. 

```{r}
#| label: fig-parl-term-5
#| fig-cap: "Σύνθεση Ελληνικού Κοινοβουλίου Ε' περιόδου (Ιούνιος, 1989 - Οκτ. 1989)"
plot_parliament(clean_dataset, 5)
```

Γενικότερα, η Βουλή από τη περίοδο του '85 μέχρι και την τελευταία Βουλή πριν την οικονομική κρίση στη χώρα μας, είχε μία σταθερότητα ως προς τον αριθμό των κομμάτων στη Βουλή. Μπορούμε αυτές τις περιόδους να τις χωρίσουμε σε τρία στάδια. Το πρώτο στάδιο είναι τα πρώτα χρόνια της Μεταπολίτευσης, όπου η εκπροσώπηση περιορίζεται σε τρία κόμματα. Στο επόμενο στάδιο, από το 1985 - 2009, έχουμε εκπροσώπους από 4 με 5 κοινοβουλευτικές ομάδες και μία χαρακτηριστική σταθερότητα ως προς αυτό το εύρος το σχετικό διάστημα (25ετία). Τέλος, με το ξέσπασμα της κρίσης παρατηρώ μία αυξημένη ένταση των κοινοβουλευτικών ομάδων 

```{r}
#| label: fig-parl-term-13
#| fig-cap: "Σύνθεση Ελληνικού Κοινοβουλίου Ε' περιόδου (2009 - 2012)"
plot_parliament(clean_dataset, 13)
```

Ενώ η όλη αποσταθεροποίηση τεκμαίρεται και από 


```{r}
plot_parliament(clean_dataset, 15)
```


::: callout-warning
Στο παρακάτω διάγραμμα υπάρχουν αρκετοί ανεξάρτητοι βουλευτές οι οποίοι ανήκουν στις κατηγορίες των ανεξάρτητων βουλευτών, σύμφωνα με την ιστοσελίδα του Ελληνικού Κοινοβουλίου. Γενικότερα εκείνη η περίοδος χαρακτηρίζεται από έντονη κυβερνητική αστάθεια, αλλά πολλοί από αυτούς προέκυψαν από τα κόμματα των Ανεξαρτήτων Ελλήνων και της Ένωσης Κεντρωών. Ένα μεγάλο κύμα αποχωρήσεων - ανεξαρτητοποιήσεων από τα προαναφερόμενα κόμματα οδήγησε στο να μην πληρούν τα κριτήρια ώστε να αποτελούν κοινοβουλευτικές ομάδες. Αυτός είναι ο λόγος που ακόμα και βουλευτές που δεν αποχώρησαν από αυτά τα κόμματα λόγω της διάλυσης της κοινοβουλευτικής ομάδας χαρακτηρίζονται ως ανεξάρτητοι.
:::

και τελικά τη πλήρη ανατροπή του πολιτικού σκηνικού, με ένα κόμμα που πάλευε να μπει στη Βουλή, να είναι αυτό που τελικά κατέλαβε τις περισσότερες θέσεις. 

```{r}
plot_parliament(clean_dataset, 17)
```


Όλα αυτά συνοψίζονται με έναν απλό τρόπο στη παρακάτω χρονοσειρά, όπου μετράει τον αριθμό των διάφορων κοινοβουλετικών ομάδων ανά κοινοβουλευτική περίοδο. Εδώ φαίνεται πολύ πιο ξεκάθαρα και όλα τα στάδια που περιγράψαμε προηγουμένως, της πρώιμης εκπροσωπούσης, της σταθερότητας και της απότομης αύξησης των ομάδων - διάσπασης των δυνάμεων.


```{r}
#| label: fig-num-of-parl-parties
#| fig-cap: "Αριθμός κοινοβουλευτικών ομάδων και ανεξάρτητων ανά κοινοβουλευτική θητεία"
# Summarize the number of distinct parties per period
r <- clean_dataset %>%
    distinct(period_num, period_name, dates, abbrNamesEl) %>%
    count(period_num, period_name, dates, name = "n") %>%
    arrange(period_num)

# Each point will carry: period_name (x), n (y), dates (for tooltip)
series_data <- lapply(1:nrow(r), function(i) {
    list(
        name = r$period_name[i],  # used on x-axis
        y = r$n[i],               # value
        dates = r$dates[i]        # for tooltip
    )
})

hc <- highchart() %>%
  hc_chart(type = "spline", backgroundColor = "white") %>%
  
  hc_title(
    text = "Αριθμός Κοινοβουλευτικών Ομάδων ανά Κοινοβουλευτική Περίοδο",
    style = list(fontWeight = "bold", fontSize = "16px")
  ) %>%
  
  hc_subtitle(
    text = "Ελληνικό Κοινοβούλιο – Μεταπολιτευτική περίοδος",
    style = list(color = "#555555", fontSize = "12px")
  ) %>%
  
  hc_add_series(
    name = "Κοινοβουλευτικές Ομάδες",
    data = series_data,   # same series_data list as before
    color = "#1F3A93",  
    lineWidth = 2.5,
    marker = list(radius = 4, symbol = "circle")
  ) %>%
  
  hc_xAxis(
    type = "category",
    title = list(
      text = "Κοινοβουλευτική Περίοδος",
      style = list(fontWeight = "bold")
    ),
    labels = list(rotation = 0)
  ) %>%
  
  hc_yAxis(
    title = list(
      text = "Αριθμός Ομάδων",
      style = list(fontWeight = "bold")
    ),
    allowDecimals = FALSE,
    gridLineColor = "#E6E6E6",
    gridLineWidth = 1
  ) %>%
  
  hc_tooltip(
    useHTML = TRUE,
    backgroundColor = "white",
    borderColor = "#CCCCCC",
    formatter = JS(
      "function() {
         return '<b>Περίοδος:</b> ' + this.point.name + '<br/>' +
                '<b>Διάρκεια:</b> ' + this.point.dates + '<br/>' +
                '<b>Ομάδες:</b> ' + this.point.y;
       }"
    )
  ) %>%
  
  # Remove data labels by disabling them
  hc_plotOptions(
    series = list(
      dataLabels = list(enabled = FALSE),
      states = list(hover = list(lineWidthPlus = 0))
    )
  ) %>%
  
  hc_legend(enabled = FALSE) %>%
  hc_credits(enabled = FALSE)

hc
```


::: callout-note
Λάβετε υπόψη σας ότι μέχρι αυτή τη στιγμή δεν έχω καταφέρει να θέσω - αλλάξω τη θέση των κομμάτων στα διαγράμματα του κοινοβουλίου. Αυτό θα ήταν χρήσιμο για να δηλώνεται εκτός από τον αριθμό των βουλευτών και η ευρύτερη πολιτική θέση ενός κόμματος. Συνεπώς, τα παρακάτω διαγράμματα της Βουλής, πρέπει να διαβαστούν μόνο ως προς το αριθμό βουλευτών και όχι ταυτόχρονη πολιτική θέση.
:::



## Εκλεξιμότητα

Το πόσοι βγήκαν και τα αποτελέσματα των εκλογών ήταν λίγο-πολύ γνωστά, απλώς έχει πάντα ενδιαφέρον να δοκιμάζεις τις γνώσεις σου και με την R. Όμως θα ήθελα να ξεκινήσω να απαντήσω σε ποιο ουσιαστικά ερωτήματα. Μία βασική κριτική στο πολιτικό σύστημα είναι ότι βγαίνουν συνεχώς οι ίδιοι. Βέβαια αυτή η κριτική δεν μπορεί να έχει ως αποδέκτες μόνο τους πολιτικούς, αλλά και μερίδα πολιτών που αποφασίζει να στηρίξει τους ίδιους. Δεν μπορείς να περιμένεις να δεις μία αλλαγή στο πολιτικό σύστημα αν αποφασίζεις την εξουσία μεταξύ δύο τριών κομμάτων, πόσο δε μάλλον όταν επιμένεις και στους ίδιους εκπροσώπους. Τελικά τι συνέβη στην Ελλάδα; Οι βουλευτές μας αλλάζουν ανά τακτά χρονικά διαστήματα ή εκλέγονται συνεχώς οι ίδιοι; Σε αυτή την ενότητα θα βρω ποιοι είναι οι βουλευτές που έχουν εκλεχτεί περισσότερες φορές. 

Ο υπολογισμός μου απαιτεί τη γνώση της συχνότητας εκλογής ενώ ταυτόχρονα

```{r}
#| echo: false


greek_labels <- c(
    name = "Ονοματεπώνυμο βουλευτή",
    surname1 = "Πρώτο Επίθετο",
    surname2 = "Δεύτερο Επίθετο",
    name1 = "Πρώτο Όνομα",
    name2 = "Δεύτερο Όνομα",
    father_name = "Όνομα Πατρός",
    sourceNamesEL = "Όνομα Κόμματος (αρχικό)",
    fullNamesEl = "Πλήρες Όνομα Κόμματος (ελλ.)",
    abbrNamesEl = "Συντομογραφία Κόμματος (ελλ.)",
    fullNamesEn = "Πλήρες Όνομα Κόμματος (αγγλ.)",
    abbrNamesEn = "Συντομογραφία Κόμματος (αγγλ.)",
    region = "Περιφέρεια",
    period_name = "Περίοδος",
    period_num = "Αριθμός Περιόδου",
    dates = "Διάρκεια Περιόδου",
    gender = "Εκτιμώμενο φύλο",
    Color = "Χρώμα Κόμματος"

)
```


```{r}
#| label: fig-most-elected-mps
#| fig-cap: "Βουλευτές που έχουν εκλεγεί περισσότερες φορές εκπροσωπόντας συγκεκριμένο κόμμα"
#| fig-height: 12

u = clean_dataset |>
  select(name, surname1, name1, fullNamesEl, abbrNamesEl, Color) |>
  count(name, surname1, name1, fullNamesEl, abbrNamesEl, Color) |>
  dplyr::filter(n >=9) |>
  arrange(-n) |>
  mutate(name1 = str_sub(name1,start = 1, end=1),
         surnameAndInitial = paste0(surname1, " ", name1, ".")) %>%
  arrange(desc(n))


highchart() %>%
    hc_chart(type = "bar") %>%
    hc_title(text = "Βουλευτές που εκλέχτηκαν πιο πολλές φορές") %>%
    hc_subtitle(text = "Πόσες φορές εκπροσώπησαν το συγκεκριμένο κόμμα στο Ελληνικό Κοινοβούλιο") %>%
    hc_xAxis(categories = u$surnameAndInitial) %>%
    hc_yAxis(title = list(text = "Value")) %>%
    hc_series(
        list(
            name = "# Αριθμός εκλέχτηκε",
            data = lapply(1:nrow(u), function(i) {
                list(
                    y = u$n[i],
                    affiliate = u$abbrNamesEl[i],
                    color = u$Color[i]
                )
            }),
            dataLabels = list(
                enabled = TRUE,
                format = "{y}",
                style = list(fontSize = "12px", textOutline = "none", color = "#FFFFFF")
            )
        )
    ) %>%
    hc_plotOptions(
        bar = list(
            borderRadius = 3,
            pointPadding = 0.2,
            groupPadding = 0.1
        )
    ) %>%
    hc_tooltip(
        headerFormat = "",
        pointFormat = "<b>{point.category}</b><br/>
                  Κόμμα: <b>{point.affiliate}</b><br/>
                  Εκλέχτηκε: <b>{point.y}</b> φορές"
    ) %>%
    hc_legend(enabled = FALSE) %>%
    hc_caption(
        text = "Colors represent different affiliations",
        style = list(fontSize = "12px", color = "#666666")
    )

```

Έτσι λοιπόν, φιλτράροντας τους βουλευτές με 11 εκπροσωπήσεις ή παραπάνω προκύπτει ότι σε αυτή την ομάδα ανήκουν 8 βουλευτές. Όλοι τους ανήκουν στα δύο μεγάλα κόμματα της Ελλάδας, τη Νέα Δημοκρατία και το ΠΑΣΟΚ, με τον κ. Κακλαμάνη και κ. Παπανδρέου να είναι οι βουλευτές που έχουν εκπροπσωπήσει πιο πολλές φορές το ΠΑΣΟΚ, και . Για να βρούμε βουλευτές άλλων κομμάτων θα πρέπει να χαλαρώσουμε αρκετά τον δείκτη φορών εκλογής, στις 9 ή 10 εκπροσωπήσεις, αφού η κ. Παραρήγα έχει εκλεγέι 10 φορές με το ΚΚΕ και ο κ. Δραγασάκης 9 φορές με τον ΣΥΡΙΖΑ.


## Εκλεξιμότητα κόμματος

Μέχρι στιγμής είδαμε τα μέλη του κοινοβουλίου, από το 1981 μέχρι και το 2019 που έχουν εκλεχτεί περισσότρες φορές με βάση το κόμμα που εκπροσωπούν. Θα ήταν ιδιαιτέρως χρήσιμο να μελετήσουμε όχι απλώς τη δημοφιλία ως προς τη βουλή, αλλά η μέτρηση του ίδιου χαρακτηριστικού και σε κάθε κόμμα. Βέβαια αυτή η μέτρηση έχει κάποιους περιορισμούς μιας και υπάρχουν κόμματα τα οποία έχουν αρκετά μικρή εκπροσώπηση στη Βουλή είτε δεν μακροημέρευσε και δεν είχε αρκετές θητείες εντός Βουλής. Για αυτό το λόγο θα αναλυθούν μόνο τα πιο ιστορικά κόμματα του κοινοβουλίου, δηλαδή το ΚΚΕ, η ΝΔ, το ΠΑΣΟΚ και ο ΣΥΡΙΖΑ. 

Επίσης, όσον αφορά το κομμάτι της υλοποίησης του σχετικού γραφήματος η χρήση συναρτήσεων είναι ενδεδειγμένη. Θα έχω ίδιο τύπο γραφήματος και απλώς θα πρέπει να φιλτράρω τα δεδομένα μου (ανά κόμμα), και στη συνέχεια να στοιχίσω τις τιμές μου σε φθίνουσα σειρά ανά φορές εκλογής για κάθε βουλευτή. Δηλαδή το μόνο που θα αλλάξει θα είναι το κόμμα. Έτσι θα αποφύγω την επανάληψη του κώδικά μου που είναι μία από τις βασικές αρχές του προγραμματισμού. Στην συγκεκριμένη συνάρτηση θα θέσω 3 μεταβλητές:

-   `Party` : Τα δεδομένα ποιου κόμματος πρέπει να κρατήσω
-   `color` : Το χρώμα, έτσι ώστε να συμπίπτει το χρώμα των ράβδων με το κόμμα το οποίο εκπροσωπούν
-   `times_elected_min` : Μία μεταβλητή που έθεσα αργότερα. Το πρόβλημα που προέκυψε με την αρχική συνάρτηση είναι ότι υπήρχαν σημαντικές διαφορές στου ς εκλεγμένους βουλευτές μεταξύ των κομμάτων που εκλέγουν σταθερά μεγάλο αριθμό βουλευτών. Αν θέσω έναν γενικό αριθμό 
    and some others just 10. If I set a universal number of elections to
    visualize I will have diagrams with many problems. Let's suppose that I set
    a big value (e.g., 10). Then I would visualize my data for *ND* and *PASOK*,
    although parties with relatively low number of MPs would have only one or
    noone to show (*KKE* & *SYRIZA*, respectively). On the other hand if I set a
    low value I create a new problem as there will be many MPs of and it creates
    the need to edit many more things (like width of bars). An argument like
    `times_elected_min` can adapt the specific characteristics of each party.

```{r}
party_plot <- function(party, party_color, times_elected_min){
  party_df = parliament %>% filter(Party == party) %>%
  select(FullName) %>% table() %>% sort(decreasing = TRUE) %>% as.data.frame() %>% filter(Freq >= times_elected_min) %>% `colnames<-`(c("Full_Name", "Freq"))
  
ggplot(data = party_df, aes(x = reorder(Full_Name , Freq), y = Freq))+
  geom_bar(stat = "identity",width = 0.88, fill = party_color) +
  geom_text(aes(label=Freq), hjust = 1.5, vjust=0.5, color="white", size=4)+
  theme_minimal() +
   labs(title = "Most elected MPs",
       subtitle = "",
       caption = "Source: stesiam | stesiam.github.io, 2022",
       x = "Times elected",
       y = "Members of Parliament") +
  coord_flip()
}
```

```{r}
party_plot <- function(dataset, party, times_elected_min = 2,
                       title_text = NULL, subtitle_text = NULL,
                       party_color = "#1F3A93") {
    
    # Filter and summarize data
    party_df <- dataset %>%
        dplyr::filter(abbrNamesEl == party) %>%        # filter by party
        count(name,surname1, name1) %>%                     # count times elected
        arrange(-n) %>%                               # descending order
        drop_na() %>%
        dplyr::filter(n >= times_elected_min) %>%     # filter by min times elected
        mutate(fullname = paste0(surname1, " ", name1)) %>%
        separate(fullname, into = c("lastNameGR", "firstNameGR"), sep = " ", extra = "merge") %>%
        mutate(
            fullNameGR = paste0(lastNameGR, " ", firstNameGR),
            lastNameAndInitialGR = paste0(lastNameGR, " ", str_sub(firstNameGR, 1, 1), ".")
        )
    
    # Create highcharter plot
    hc <- highchart() %>%
        hc_chart(type = "bar", inverted = TRUE, backgroundColor = "white") %>%
        
        hc_title(
            text = title_text,
            style = list(fontWeight = "bold", fontSize = "16px")
        ) %>%
        
        hc_subtitle(
            text = subtitle_text,
            style = list(color = "#555555", fontSize = "12px")
        ) %>%
        
        hc_xAxis(
            categories = party_df$lastNameAndInitialGR,
            title = list(text = NULL),
            labels = list(
                style = list(fontSize = "11px", whiteSpace = "nowrap"),
                useHTML = TRUE
            )
        ) %>%
        
        hc_yAxis(
            title = list(text = "(#) Φορές εκλέχτηκε"),
            allowDecimals = FALSE,
            gridLineColor = "#E6E6E6",
            gridLineWidth = 1
        ) %>%
        
        hc_add_series(
            name = "Times elected",
            data = party_df$n,
            color = party_color
        ) %>%
        
        hc_plotOptions(
            bar = list(
                dataLabels = list(enabled = FALSE)  # hide numbers on bars
            )
        ) %>%
        
        hc_tooltip(
            useHTML = TRUE,
            headerFormat = "",
            pointFormat = paste0(
                "<b>{point.category}</b><br/>",
                "Κόμμα: <b>", party, "</b><br/>",
                "Εκλέχτηκε: <b>{point.y}</b> φορές"
            )
        ) %>%
        
        hc_legend(enabled = FALSE) %>%
        hc_credits(enabled = FALSE)
    
    return(hc)
    
}
```


Τα αποτελέσματα παρουσιάζονται με αλφαβητική σειρά με βάση το όνομα του εκάστοτε κόμματος.

### ΚΚΕ

::: {.column-margin}
![](images/Aleka_Papariga.png)

Η Αλέκα Παπαρήγα (Αθήνα, 1945 - ) είναι η πιο εκλεγμένη γυναίκα βουλευτής του Ελληνικού Κοινοβουλίου (1981-2019). Υπήρξε επικεφαλής του Κομμουνιστικού Κόμματος Ελλάδας (ΚΚΕ).
<br>
**Πηγή φωτογραφίας: **Wikimedia Commons, 2015 - Άδεια χρήσης: [CC BY-SA 2.0](https://creativecommons.org/licenses/by-sa/2.0/deed.el). Για τη πρωτότυπη φωτογραφία μπορείτε να πατήσετε τον [σύνδεσμο](https://commons.wikimedia.org/w/index.php?title=File:Aleka_Papariga_2009_(cropped).jpg&oldid=788372285)
:::

```{r}
party_plot(
  dataset = clean_dataset,
  party = "ΚΚΕ",  # Example party abbreviation from abbrNamesEl
  times_elected_min = 5,
  title_text = "Βουλευτές του Κόμματος ΚΚΕ με πάνω από 5 θητείες",
  subtitle_text = "Αριθμός εκλογών ανά βουλευτή",
  party_color = "#FF6666"
)
```

### ΝΔ

::: {.column-margin}
![](images/mitso.webp)

Ο Κωνσταντίνος Μητσοτάκης (Χαλέπα Χανίων, 1918 - 2017) ήταν Έλληνας πολιτικός. Διετέλεσε πρωθυπουργός της χώρας από το 1990 μέχρι τον Οκτώβριο του 1993. Ο γιος του, Κυριάκος Μητσοτάκης, αναδείχθηκε αρχηγός του κόμματος το 2016 και το 2019 εκλέχτηκε πρωθυπουργός της χώρας.
<br>
**Πηγή φωτογραφίας: **Ελληνικό Λογοτεχνικό και Ιστορικό Αρχείο - Μορφωτικό Ίδρυμα Εθνικής Τραπέζης, 1950 - Άδεια χρήσης: [CC BY](https://creativecommons.org/licenses/by/4.0/). Η φωτογραφία έχει υποστεί βασική επεξεργασία (περικοπή και αφαίρεση φόντου). Η πρωτότυπη εικόνα βρέθηκε στο [Europeana](https://www.europeana.eu/en/item/122/https___www_searchculture_gr_aggregator_edm_ELIA_000100_22_428759).
:::

```{r}
party_plot(
  dataset = clean_dataset,
  party = "ΝΔ",  # Example party abbreviation from abbrNamesEl
  times_elected_min = 10,
  title_text = "Βουλευτές του Κόμματος ΝΔ με πάνω από 10 θητείες",
  subtitle_text = "Αριθμός εκλογών ανά βουλευτή",
  party_color = "#0492c2"
)
```

### ΠΑΣΟΚ




::: {.column-margin}
![](images/papandreou.webp)

Ο Ανδρέας Γ. Παπανδρέου (Χίος, 1919-1996) ήταν Έλληνας πολιτικός, ιδρυτής και αρχηγός του ΠΑ.ΣΟ.Κ (Πανελλήνιο Σοσιαλιστικό Κίνημα). Διετέλεσε πρωθυπουργός της χώρας από το 1981 μέχρι και το 1989 καθώς και από το 1991 μέχρι το 1996. Κατά τη διακυβέρνησή του έκανε σημαντικές μεταρρυθμίσεις κοινωνικού χαρακτήρα όπως η κατάργηση του θεσμού της προίκας, καθιέρωση του πολιτικού γάμου,  διεύρυνση δικαιώματος ψήφου μειώνοντας το ηλικιακό όριο από τα 21 στα 18 έτη. Μία σημαντική συνεισφορά είναι η ίδρυση του Εθνικού Συστήματος Υγείας (ΕΣΥ). Έχει δεχτεί κριτική για την τεράστια αύξηση των δημοσίων δαπανών, της αύξησης του χρέους της χώρας, την αύξηση των δημοσίων υπαλλήλων που συνοδεύτηκαν από αδιαφανείς διαδικασίες επιλογής.
<br>
**Πηγή φωτογραφίας: **Wikimedia - Φωτογραφία του 1981 - Άδεια χρήσης: Public Domain. Η πρωτότυπη εικόνα βρέθηκε στο [Europeana](https://commons.wikimedia.org/wiki/File:1981_Press_Photo_Andreas_Papandreou_(3x4_cropped).png).
:::

```{r}
party_plot(
  dataset = clean_dataset,
  party = "ΠΑΣΟΚ",  # Example party abbreviation from abbrNamesEl
  times_elected_min = 10,
  title_text = "Βουλευτές του Κόμματος ΝΔ με πάνω από 10 θητείες",
  subtitle_text = "Αριθμός εκλογών ανά βουλευτή",
  party_color = "#95bb72"
)
```

### ΣΥΡΙΖΑ

```{r}
party_plot(
  dataset = clean_dataset,
  party = "ΣΥΡΙΖΑ",  # Example party abbreviation from abbrNamesEl
  times_elected_min = 5,
  title_text = "Βουλευτές του Κόμματος ΝΔ με πάνω από 5 θητείες",
  subtitle_text = "Αριθμός εκλογών ανά βουλευτή",
  party_color = "#e27bb1"
)
```

## Δικομματισμός στην Ελλάδα

Η διαχρονική επιμονή τόσο σε κόμματα, όσο και σε ίδια πρόσωπα είναι ξεκάθαρη. Ένα ενδιαφέρον στοιχείο θα ήταν το ποσοστό του δικομματισμού, δηλαδή το ποσοστό το οποίο συγκεντρώνουν τα δύο μεγαλύτερα κόμματα. Αυτή η τάση γνωρίζουμε ειδικά στα πρώτα χρόνια της μεταπολίτευσης ήταν αρκετά υψηλή. Σε αυτή την ενότητα δεν θα αναλύσω απευθείας τα δεδομένα των εκλογών, αλλά των εκλεγμένων βουλευτών και θα συγκρίνω τι ποσοστό αυτών ανήκουν στα πρώτα δύο κόμματα. Εδώ βέβαια θα πρέπει να διευκρινιστεί ότι υπάρχει μεγάλη απόκλιση μεταξύ των εκλογικών ποσοστών και των ποσοστών εδρών στη Βουλή κυρίως λόγω του μπόνους εδρών στο πρώτο κόμμα και των εξωκοινοβουλευτικών κομμάτων. Έχει ενδιαφέρον να εξετάσουμε τη πόλωση διαχρονικά και αν δούμε μειωμένα ποσοστά αυτό ενδεχομένως να σημαίνει μία κάποια αντίδραση στο πολιτικό σύστημα. Στο συγκεκριμένο διάγραμμα παρατηρώ εξαιρετικά υψηλά ποσοστά εκπροσώπησης στη Βουλή για τα πρώτα δύο κόμματα. Τα χρόνια της κρίσης τα ποσοστά των δύο πρώτων έχουν πέσει σημαντικά και από εκεί που εκπροσωπούσαν το 80\%, πλέον αντιστοιχούν στο 60\%. Από προηγούμενες παραγράφους γνωρίζουμε ότι το Ελληνικό Κοινοβούλιο τα χρόνια της κρίσης αύξησε κατά πολύ τις κοινοβουλευτικές ομάδες που είχε. Συνδυάζοντας τα παραπάνω τεκμαίρετε ότι υπήρχε μία αντίδραση του κόσμου η οποία ξεκίνησε με το ξεκίνημα της οικονομικής κρίσης η οποία μεν δεν άλλαξε το πολιτικό σκηνικό από θέμα κομμάτων, αλλά έσπασε το δίπολο και η αντίδραση του κόσμου διαχύθηκε σε διάφορα μικρότερα κόμματα.


```{r}
f = clean_dataset %>% dplyr::group_by(period_name, abbrNamesEl) %>% count() %>% ungroup(abbrNamesEl) %>% top_n(., n =2, wt = n) %>% tidyr::pivot_wider(., names_from = abbrNamesEl, values_from = n) %>%
    mutate(seatsTopTwoParties = rowSums(across(c(ΝΔ, ΠΑΣΟΚ, ΣΥΡΙΖΑ)), na.rm = TRUE)) %>%
    mutate(pctSeatsTopTwoParties = round( (seatsTopTwoParties/ 300) * 100, digits = 1) )

highchart() %>%
    hc_chart(type = "spline") %>%
    hc_title(text = "Εκπροσώπηση δικομματισμού", style = list(fontSize = "20px", fontWeight = "bold")) %>%
    hc_subtitle(text = "Ποσοστό (%) εκπροσώπησης δικομματισμού στην Ελληνική Βουλή") %>%
    hc_xAxis(categories = f$Term , title = list(text = "Θητείες"), gridLineWidth = 0) %>%
    hc_yAxis(title = list(text = "Ποσοστό θέσεων δύο πρώτων κομμάτων (%)"), gridLineWidth = 0) %>%
    hc_add_series(
        data = f$pctSeatsTopTwoParties,
        name = "Ποσοστό",
        color = "#6366F1",
        marker = list(enabled = TRUE, radius = 4, symbol = "circle")
    ) %>%
     hc_tooltip(
    useHTML = TRUE,
    headerFormat = '<span style="font-size:14px;">Θητεία<b>: {point.x}</b></span><br/>',
    pointFormat = '<span style="color:{series.color};">●</span> <b>{series.name}</b>: {point.y}<br/>',
    backgroundColor = "#ffffff",
    borderColor = "#e5e7eb",
    style = list(color = "#111827", fontSize = "14px")
  ) %>%
  hc_plotOptions(
    spline = list(
      lineWidth = 4,
      marker = list(symbol = "circle", radius = 5)
    )
  ) %>%
    hc_legend(enabled = FALSE)
```


## Εκλογιμότητα γυναικών

Μία σημαντική ένδειξη υγείας του κοινοβουλίου και συνεπακόλουθα της κοινωνίας είναι η αντιπροσωπευτικότητα αυτού. Να μπορούν να ακουστούν όλες οι φωνές και όλα τα κοινωνικά ζητήματα. Μία από τις πιο προφανείς είναι κατά πόσο η κοινωνία εξελίσσεται και αποδέχεται ως εξίσου ικανές τις γυναίκες για αντιπροσώπους της νομοθετικής εξουσίας. Ιστορικά, η χώρα μας πάσχει σε αυτό το τομέα, με τις γυναίκες να υποεκπροσωπούνται στην αγορά εργασίας. Τα ίδια κοινωνικά στερεότυπα δείχνουν να κυριαρχούν ακόμα με χαλητότατη εκλογή γυναικών βουλευτών. Μέχρι και τις πρώτες 10 περιόδους του Ελληνικού Κοινοβουλίου οι γυναίκες αντιπροσώπευαν λιγότερο από το 10\% των συνολικών βουλευτών. Αξίζει να σημειώσουμε ότι οι γυναίκες στην Ελλάδα έλαβαν δικαίωμα ψήφου το 1952Τα τελευταία χρόνια η κατάσταση έχει βελτιωθεί και έχει κατά κάποιο τρόπο κανο

::: {.column-margin}
![](images/el_skoura.png)

Η Ελένη Σκούρα (Bόλος, 1896 - 1991) ήταν η πρώτη Ελληνίδα βουλευτής, η οποία εκλέχτηκε το 1953, ένα χρόνο αφού ψηφίστηκε το δικαίωμα ψήφου και εκλογής στις γυναίκες.
<br>
**Πηγή φωτογραφίας: **Ελληνικό Λογοτεχνικό και Ιστορικό Αρχείο - Μορφωτικό Ίδρυμα Εθνικής Τραπέζης, 1940 - Άδεια χρήσης: [CC BY](https://creativecommons.org/licenses/by/4.0/). Η φωτογραφία έχει υποστεί βασική επεξεργασία (περικοπή και μετατροπή σε σκίτσο). Η πρωτότυπη εικόνα βρέθηκε στο [Europeana](https://www.europeana.eu/el/item/122/https___www_searchculture_gr_aggregator_edm_ELIA_000100_22_501199#main).
:::

```{r}
test <- clean_dataset |> select(period_num, gender)

test1 <- test |>
    group_by(period_num, gender) |>
    count() |>
    pivot_wider(names_from = gender, values_from = n, values_fill = 0) # fill missing with 0

colors <- c(
    "#90C3FF",  # blue for men
    "#FF9090"   # red for women
)

# Create professional stacked percent area plot
highchart() %>%
    hc_chart(type = "areaspline", backgroundColor = "white") %>%
    
    hc_title(
        text = "Κατηγορίες αποφοίτων Στατιστικής ανά φύλο",
        style = list(fontSize = "20px", fontWeight = "bold")
    ) %>%
    
    hc_subtitle(
        text = "Ποσοστιαία κατανομή φοιτητών και φοιτητριών ανά θητεία. Η κατηγορία βαθμού 6-7 είναι η πιο συχνή.",
        style = list(fontSize = "12px", color = "#555555")
    ) %>%
    
    hc_xAxis(
        categories = test1$period_num,
        title = list(text = "Θητείες"),
        labels = list(style = list(fontSize = "11px"))
    ) %>%
    
    hc_yAxis(
        title = list(text = "Ποσοστό (%)"),
        labels = list(format = "{value}%"),
        max = 100,
        gridLineColor = "#E6E6E6",
        gridLineWidth = 1
    ) %>%
    
    hc_colors(colors) %>%
    
    hc_plotOptions(
        areaspline = list(
            stacking = "percent",   # stack to percent
            lineWidth = 2,
            fillOpacity = 0.6,
            marker = list(enabled = FALSE)
        )
    ) %>%
    
    hc_add_series(name = "Βουλευτές", data = test1$άνδρας) %>%
    hc_add_series(name = "Βουλεύτριες", data = test1$γυναίκα) %>%
    
    hc_tooltip(
        shared = TRUE,
        useHTML = TRUE,
        formatter = JS("
    function() {
      var total = 0;
      for (var i = 0; i < this.points.length; i++) {
        total += this.points[i].y;
      }
      // get the category name from the x-axis categories
      var categoryName = this.points[0].series.xAxis.categories[this.points[0].point.x];
      
      var s = '<b>' + categoryName + '</b><br>';
      for (var i = 0; i < this.points.length; i++) {
        var pct = Math.round((this.points[i].y / total) * 100);
        s += '<span style=\"color:' + this.points[i].color + '\">●</span> ' +
             this.points[i].series.name + ': ' + this.points[i].y + ' (' + pct + '%)<br>';
      }
      return s;
    }
  ")
    ) %>%
    
    hc_legend(
        layout = "horizontal",
        align = "center",
        verticalAlign = "bottom"
    ) %>%
    
    hc_credits(enabled = FALSE)
```

Βέβαια, το να ρίξουμε όλο το βάρος στη κοινωνία είναι λίγο άδικο υπό το έρεισμα ότι. Μήπως και τα κόμματα δεν προβάλλουν τόσο μιας και η ανάλυση επεκτάθηκε και σε επίπεδο κομμάτων. Εδώ φαίνεται ότι η Νέα Δημοκρατία ως πιο συντηρητικό κόμμα είναι αυτό που έχει σταθερά πολύ χαμηλή εκπροσώπηση των γυναικων. Από την άλλη μεριά παρατηρούμε αρκετά μεγάλη διαφορά στα αριστερά κόμματα με σταθερή παρουσία γυναικών και σε σημαντικά υψηλότερα ποσοστά. Από τα κόμματα με διαχρονική παρουσία στη Βουλή το ΚΚΕ υπήρξε αυτό με την υψηλότερη συμμετοχή γυναικών στην 11η περίοδο της Βουλής, ακολουθούμενη από τον ΣΥΡΙΖΑ, την 15η περίοδο με 38\% η οποία ήταν αρκετά σημαντική καθώς εκτός από ποσοστιαία σημαντική ήταν και σε απόλυτους αριθμούς μιας και εκείνο το καιρό ο ΣΥΡΙΖΑ είχε αρκετά μεγάλα ποσοστά και σημαντική εκπροσώπηση στη Βουλή.

::: {.column-margin}
![](images/vas_thanou.png){fig-align="center"}

Η Βασιλική Θάνου (Χαλκίδα, 1950 - ) είναι η πρώτη γυναίκα που έχει διατελέσει πρωθυπουργός. Ήταν υπηρεσιακή πρωθυπουργός όταν έπεσε η κυβέρνηση του ΣΥΡΙΖΑ και προκηρύχθηκαν εκλογές. Μέχρι και σήμερα αποτελεί τη μοναδική γυναίκα που έχει υπάρξει σε αυτό το αξίωμα. 
<br>
**Πηγή φωτογραφίας: **Wikimedia Commons, 2015 - Άδεια χρήσης: [CC BY-SA 2.0](https://creativecommons.org/licenses/by-sa/2.0/). Η φωτογραφία έχει υποστεί βασική επεξεργασία.
:::


```{r}
test = clean_dataset |> select(period_num, gender, abbrNamesEl)
test1 = test |>
  group_by(period_num, gender, abbrNamesEl) |>
  count() |>
  pivot_wider(names_from = gender, values_from = n) %>%
  mutate(across(c(άνδρας, γυναίκα), ~ replace_na(., 0))) %>%
  mutate(
    sum = γυναίκα + άνδρας,
    pct = round( 100 * (γυναίκα / sum), 1) ) %>%
  ungroup() %>%
  select(period_num, abbrNamesEl, pct) %>%
  dplyr::filter(abbrNamesEl %in% c("ΣΥΡΙΖΑ", "ΝΔ", "ΠΑΣΟΚ", "ΚΚΕ")) %>%
  group_by(period_num) %>%
  pivot_wider(names_from = abbrNamesEl, values_from = pct) %>%
  dplyr::filter(period_num > 9)


highchart() %>%
  hc_chart(type = "spline") %>%
  hc_title(text = "Συμμετοχή γυναικών ανά κόμμα") %>%
  hc_subtitle(text = "Η Νέα Δημοκρατία ποτέ στην ιστορία της δεν εκπροσωπήθηκε από γυναίκες σε υψηλότερο του 17%, σε αντίθεση με άλλα ιστορικά κόμματα, όπως ο ΣΥΡΙΖΑ, το ΚΚΕ και το ΠΑΣΟΚ.") %>%
  hc_xAxis(
    categories = test1$period_num,
    title = list(text = "Κοινοβουλευτικές θητείες")
  ) %>%
  hc_yAxis(reverse = TRUE,
    title = list(text = "Ποσοστό (%) γυναικών")
  ) %>%
  hc_add_series(name = "ΚΚΕ", data = test1$ΚΚΕ, color = "#ff6666") %>%
  hc_add_series(name = "ΝΔ", data = test1$ΝΔ, color = "#0492c2") %>%
  hc_add_series(name = "ΠΑΣΟΚ", data = test1$ΠΑΣΟΚ, color = "#95bb72") %>%
  hc_add_series(name = "ΣΥΡΙΖΑ", data = test1$ΣΥΡΙΖΑ, color = "#e27bb1") %>%

  hc_tooltip(shared = TRUE)
```

## Εκλεξιμότητα νομού

Αυτή τη στιγμή έχω υπολογίσει

-   τη σύνθεση των κοινοβουλίων ανά θητεία
-   τους βουλευτές με τις περισσότερες θητείες σε εθνικό επίπεδο
-   τους βουλευτές με τις περισσότερες θητείες σε επίπεδο κόμματος

Τώρα, θα υπολογίσω τους πιο δημοφιλείς βουλευτές, ανά νομό. Προφανώς, σε αυτή τη περίπτωση εφαρμόζεται γ ίδια λογική με αυτή της προηγούμενης ενότητας (με μικρές μετατροπές). Εγώ προσωπικά θα χαρακτήριζα τη χρήση συναρτήσεων σε αυτή τη περίπτωση σχεδόν υποχρεωτική, μιας και όλοι οι νομοί είναι 50! Για την εύρεση των συχνοτήτων θα χρησιμοποιήσω τη εντολή count.

```{r}
constituency_freqs <- function(input_constituency, min_times_elected){
  cont_df = clean_dataset %>% dplyr::filter(region == input_constituency) %>% 
    count(surname1, name1, fullNamesEl, abbrNamesEl, Color) %>%
    arrange(-n) |>
    dplyr::filter(n >= min_times_elected) %>%
    mutate(FullNameInitial = paste0(surname1, " ", str_sub(name1, 1, 1), "."))
  
highchart() %>%
    hc_chart(type = "bar") %>%
    hc_title(text = "Βουλευτές που εκλέχτηκαν πιο πολλές φορές") %>%
    hc_subtitle(text = "Πόσες φορές εκπροσώπησαν το συγκεκριμένο κόμμα στο Ελληνικό Κοινοβούλιο") %>%
    hc_xAxis(categories = cont_df$FullNameInitial) %>%
    hc_yAxis(title = list(text = "Value")) %>%
    hc_series(
        list(
            name = "# Αριθμός εκλέχτηκε",
            data = lapply(1:nrow(cont_df), function(i) {
                list(
                    y = cont_df$n[i],
                    affiliate = cont_df$abbrNamesEl[i],
                    color = cont_df$Color[i]
                )
            }),
            dataLabels = list(
                enabled = TRUE,
                format = "{y}",
                style = list(fontSize = "12px", textOutline = "none", color = "#FFFFFF")
            )
        )
    ) %>%
    hc_plotOptions(
        bar = list(
            borderRadius = 3,
            pointPadding = 0.2,
            groupPadding = 0.1
        )
    ) %>%
    hc_tooltip(
        headerFormat = "",
        pointFormat = "<b>{point.category}</b><br/>
                  Κόμμα: <b>{point.affiliate}</b><br/>
                  Εκλέχτηκε: <b>{point.y}</b> φορές"
    ) %>%
    hc_legend(enabled = FALSE) %>%
    hc_caption(
        text = "Colors represent different affiliations",
        style = list(fontSize = "12px", color = "#666666")
    )  
}
```


### Επικρατείας {.unlisted}

```{r}
constituency_freqs("ΕΠΙΚΡΑΤΕΙΑΣ", 3)
```

### Αττικής {.unlisted}

::: panel-tabset
#### Α' Αθηνών

```{r}
constituency_freqs("Α' ΑΘΗΝΩΝ",5)
```

#### Β' Αθηνών

```{r}
constituency_freqs("Β' ΑΘΗΝΩΝ",7)
```

#### Α' Πειραιά

```{r}
constituency_freqs("Α' ΠΕΙΡΑΙΩΣ",5)
```

#### Β' Πειραιώς

```{r}
constituency_freqs("Β' ΠΕΙΡΑΙΩΣ",5)
```

:::

### Κεντρική Ελλάδα {.unlisted}

::: panel-tabset
#### Βοιωτία

```{r}
constituency_freqs("ΒΟΙΩΤΙΑΣ",5)
```

#### Ευρυτανία

```{r}
constituency_freqs("ΕΥΡΥΤΑΝΙΑΣ",2)
```

#### Φωκίδα

```{r}
constituency_freqs("ΦΩΚΙΔΑΣ",2)
```

#### Φθιώτιδα

```{r}
constituency_freqs("ΦΘΙΩΤΙΔΑΣ",3)
```
:::

### Κεντρική Μακεδονία {.unlisted}

::: panel-tabset
#### Α' Θεσ/νίκης

```{r}
constituency_freqs("Α' ΘΕΣΣΑΛΟΝΙΚΗΣ",6)
```

#### Β' Θεσ/νίκης

```{r}
constituency_freqs("Β' ΘΕΣΣΑΛΟΝΙΚΗΣ",6)
```

#### Κιλκίς

```{r}
constituency_freqs("ΚΙΛΚΙΣ",3)
```

#### Πέλλα

```{r}
constituency_freqs("ΠΕΛΛΑΣ",3)
```

#### Πιερία

```{r}
constituency_freqs("ΠΙΕΡΙΑΣ",3)
```

#### Σέρρες

```{r}
constituency_freqs("ΣΕΡΡΕΣ",3)
```

:::

## Κοινοβουλευτική ανανέωση

Παρατηρούμε ότι λίγα είναι τα κόμματα που κυριαρχούν στο ελληνικό πολιτικό σκηνικό και είναι κάπως ανθεκτικά στο πέρασμα του χρόνου. Παρά τη πολιτική αναταραχή και ανακτατάξεις του πολιτικού σκηνικού με το ξέσπασμα της οικονομικής κρίσης, υπήρξαν αρκετά εφήμερα κόμματα και στην ουσία είχαμε μία ανακατάταξη και μετακινήσεις ψηφοφόρων μεταξύ των ιστορικών κομμάτων. Η μη σημαντική πολιτική ανατροπή από νέα κόμματα μας οδηγεί στη πλειοψηφία της σε επιλογές προσώπων από τα κόμματα. Έτσι λοιπόν προκύπτει το απολύτως λογικό ερώτημα. Οκ, ψηφίζουμε στη συντριπτική πλειοψηφία μεταξύ τεσσάρων κομμάτων, μήπως όμως οι επιλογές μας είναι προσανατολισμένες στο να αλλάξουν τουλάχιστον τα πρόσωπα που μας εκπροσωπούν. Με απλά λόγια θα ήθελα να μελετήσω κατά πόσο κάθε νέα κοινοβουλευτική θητεία αποτελείται από βουλευτές που δεν έχουν ξαναεκλεγεί και ανανεώνεται η σύνθεση της.

Για την υλοποίηση θα χρησιμοποιήσω το τακτοποιημένο σύνολο δεδομένων και θα εξάγω δύο υποσύνολα που θα αντιστοιχούν στη $n$ βουλευτική θητεία και το άλλο στη $n+1$. Στη συνέχεια θα συγκρίνω τις τις αντίστοιχες στήλες των ονομάτων για να διαπιστώσω πόσες αντιστοιχίσεις υπάρχουν, δηλαδή επανεκλογή βουλευτών. Επίσης, λαμβάνω υπόψιν στη πρόσφατη εκλογή με όλες τις παλαιότερες περιόδους ώστε να εντοπίσω και παλαιότερες εκλογές ίδιων προσώπων που μπορεί να μην εκλέχτηκαν στις προηγούμενες εκλογές.

Σε αυτή τη περίπτωση μελετάμε τη περίοδο 1981 - 2019 (Γ' περίοδος - ΙΖ´ περίοδος), επομένως η σύγκριση έχει νόημα να ξεκινήσει από τη περίοδο Δ' (1985), ώστε να να έχω προηγούμενη περίοδο σύγκρισης. Στο διάγραμμα υπάρχουν τάσεις που υποδεικνύουν ισχυρές τάσεις διατήρησης όμοιων προσώπων με 

Τέλος, μόνο δύο εκλογικές αναμετρήσεις οδήγησαν σε σημαντική ανανέωση του κοινοβουλίου αντικαθιστώντας ουσιαστικά τα μισά μέλη με νεοεκλεγέντες, 

```{r}
get_new_members <- function(term){
    
    # Members from previous terms
    previous_parls <- clean_dataset |>
        dplyr::filter(period_num < term) |>
        dplyr::select(name)
    
    # Members in the current term
    current_parl <- clean_dataset |>
        dplyr::filter(period_num == term) |>
        dplyr::select(name)
    
    # Count total in current term
    how_many_current_term <- nrow(current_parl)
    
    # Count those who were already in previous terms
    established_members <- sum(current_parl$name %in% previous_parls$name)
    
    # Count new members
    new_members <- how_many_current_term - established_members
    
    return(list(established_members, new_members))
}

# Apply to terms 4 through 17
results <- lapply(4:17, get_new_members)

# Prepare data frame for plotting
df <- data.frame(
    num = 4:17,
    established = sapply(results, `[[`, 1),
    new = sapply(results, `[[`, 2)
)

# Highchart plot
highchart() %>%
    hc_chart(type = "areaspline") %>%
    hc_xAxis(categories = df$num) %>%
    hc_yAxis(title = list(text = "Ποσοστό νέων βουλευτών")) %>%
    hc_title(text = "Βουλευτές που εκλέγονται πρώτη φορά") %>%
    hc_subtitle(text = "Οι βαθμοί που κυριαρχούν είναι κάτω του 7, προσεγγίζοντας ακόμα και το 90%. Οι απόφοιτοι με βαθμό πτυχίου από 6 μέχρι και 7 είναι οι πιο συχνοί και καταλαμβάνουν το 55% με 70% των συνολικών αποφοίτων") %>%
    hc_colors(c("#1f77b4", "#ff7f0e")) %>%
    hc_plotOptions(
        areaspline = list(
            stacking = "percent",
            marker = list(enabled = FALSE),
            lineWidth = 2,
            fillOpacity = 0.6
        )
    ) %>%
    hc_add_series(name = "Παλιοί βουλευτές", data = df$established) %>%
    hc_add_series(name = "Πρώτη θητεία", data = df$new) %>%
    hc_tooltip(shared = TRUE)
```




## Σωρευτικός αριθμός βουλευτών

Σε όλη τη έκταση του άρθρου μελέτησα την ένταση της εκλογής των κομμάτων ή των βουλευτών ανά κοινοβουλευτική περίοδο. Έκρινα χρήσιμη να υπάρχει και μία συνολική ανασκόπηση των αποτελεσμάτων των εκλογών. Η κριτική της μη πραγματικής πολιτικής αλλαγής εκφράζεται μέσα και από την διαχρονική επιμονή σε εκπροσώπους από συγκεκριμένα κόμματα. Υπολογίζουμε λοιπόν το συνολικό αριθμό - ποσοστό των βουλευτών με βάση το κόμμα που εκπροσωπούσαν στο τέλος της κάθε θητείας. Το ΠΑΣΟΚ και η Νέα Δημοκρατία αποτελούν τα κόμματα που η εκπροσώπησή τους ξεπέρασε τα 3/4 των συνολικών βουλευτών στην ιστορία του κοινοβουλίου. Αν συμπεριλάβω το ΚΚΕ και το ΣΥΡΙΖΑ, τότε το συνολικό ποσοστό από όλα τα προαναφερθέντα κόμματα αγγίζει το 90\%. Όλα τα υπόλοιπα αποτελούν ανεξάρτητους βουλευτές ή βουλευτές μικρότερων κομμάτων, στοιχείο που συνηγορεί ότι είμαστε αρκετά μακριά από τη λογική της πολιτικής αλλαγής.

```{r}
library(dplyr)
library(highcharter)

# Summarize party counts using the new variable `abbrNamesEl`
gh <- clean_dataset |>
  count(abbrNamesEl) |>
  arrange(-n) |>
  mutate(abbrNamesEl = ifelse(n > 70, abbrNamesEl, "Άλλο")) |>
  group_by(abbrNamesEl) |>
  mutate(n = sum(n)) |>
  distinct() |>
  ungroup() |>
  mutate(pct = round( (n / sum(n))*100 , 1)) |>
  # get a color per party
  left_join(
    clean_dataset |> 
      group_by(abbrNamesEl) |> 
      summarise(Color = first(Color), .groups = "drop"),
    by = "abbrNamesEl"
  )

# Prepare data for highcharter pie with colors
pie_data <- lapply(1:nrow(gh), function(i){
  list(
    name = gh$abbrNamesEl[i],
    y    = gh$pct[i],
    color = gh$Color[i]
  )
})

# Highcharter semicircle donut
highchart() %>%
  hc_chart(type = "pie", backgroundColor = NULL) %>%
  hc_title(text = "Σύνολο εκπροσώπησης βουλευτών ανά κόμμα (1981 - 2019)", align = "center") %>%
  hc_subtitle(text = "Το ΠΑΣΟΚ και η Νέα Δημοκρατία αριθμούν το 76% των βουλευτών της ιστορίας του κοινοβουλίου") %>%
  hc_plotOptions(pie = list(
    startAngle = -90,
    endAngle   = 90,
    center     = c("50%", "75%"),
    size       = "110%",
    innerSize  = "60%",
    showInLegend = TRUE,
    dataLabels = list(
      enabled = TRUE,
      distance = -30,
      style = list(fontSize = "12px"),
      formatter = JS("function() { return '<b>'+ this.point.name +'</b>: '+ this.percentage.toFixed(1) +'%'; }")
    )
  )) %>%
  hc_add_series(
    name = "Share",
    data = pie_data
  ) %>%
  hc_tooltip(pointFormat = '{series.name}: <b>{point.percentage:.1f}%</b>') %>%
  hc_legend(layout = "horizontal", align = "center", verticalAlign = "bottom") 
```

Τέλος, έχει αντίστοιχο ενδιαφέρον να μελετήσουμε το σωρευτικό ποσοστό συμμετοχής των γυναικών στο Ελληνικό Κοινοβούλιο. Για τα αποτελέσματα δεν είμαστε ιδιαίτερα αισιόδοξοι μιας και σε προηγούμενη ενότητα διαπιστώσαμε ότι είναι ιστορικά χαμηλή με την υψηλότερη να κυμαίνεται τα τελευταία χρόνια στο 25\%. Η εικόνα δεν είναι καθόλου καλή όταν αναλύσουμε το φύλο σε βάθος 40ετίας μιας και το ποσοστό των βουλευτριών περιορίζεται στο 12.8\%. Σε απόλυτους αριθμούς αυτό αντιστοιχεί σε 576 γυναίκες, έναντι 3927 ανδρών συναδέλφων τους.

```{r}
gh = clean_dataset |>
  count(gender) |>
  arrange(-n) |>
  mutate(pct = round( 100* (n/sum(n)), digits = 1) ) |>
  drop_na(gender)

colors <- c(
  "#90C3FF",
  "#FF9090"
)

highchart() %>%
    hc_chart(type = "pie") %>%
    hc_title(text = "Σύνολο εκπροσώπησης βουλευτών ανά φύλο (1981 - 2019)", align = "center") %>%
    hc_subtitle(text = "Οι γυναίκες υποεκπροσωπούνται ιστορικά. Σε όλη την πρόσφατη ιστορία του Ελληνικού Κοινοβουλίου οι γυναίκες αποτελούν μόλις το 13% των συνολικά εκλεγμένων βουλευτών") %>%
    hc_plotOptions(pie = list(
        # key settings to make it a semicircle donut
        startAngle = -90,      # start at left-bottom
        endAngle   = 90,       # end at right-bottom -> forms a half circle
        center     = c("50%", "75%"), # vertically lower so the semi-circle sits nicely
        size       = "110%",   # overall size of the pie
        innerSize  = "60%",    # makes it a donut (adjust for thicker/thinner ring)
        showInLegend = TRUE,
        dataLabels = list(
            enabled = TRUE,
            distance = -30,      # place labels inside the ring; tweak as needed
            style = list(fontSize = "12px"),
            formatter = JS("function() { return '<b>'+ this.point.name +'</b>: '+ this.percentage.toFixed(1) +'%'; }")
        )
    )) %>%
    hc_add_series(
        name = "Share",
        data = list_parse2(gh)
    ) %>%
    hc_colors(colors) %>%
    hc_tooltip(pointFormat = '{series.name}: <b>{point.percentage:.1f}%</b>') %>%
    hc_legend(layout = "horizontal", align = "center", verticalAlign = "bottom")  
```



# Ευχαριστίες - Τελικές σημειώσεις {.appendix}

Εικόνα του/της
<a href="https://pixabay.com/users/leonhard_niederwimmer-1131094/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=7402132">Leonhard
Niederwimmer</a> από την ιστοσελίδα
<a href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=7402132">Pixabay</a>
<br>

Τα εξορυγμένα δεδομένα που χρησιμοποιώ στο άρθρο παρέχονται και είναι ελεύθερα προσβάσιμα από το σχετικό αποθετήριο μου <a href="https://github.com/stesiam/Greek-MPs-Dataset">στο GitHub</a>. Τα περισσότερα δεδομένα προέρχονται από την ιστοσελίδα του <a href="https://www.hellenicparliament.gr">ελληνικού κοινοβουλίου</a>
