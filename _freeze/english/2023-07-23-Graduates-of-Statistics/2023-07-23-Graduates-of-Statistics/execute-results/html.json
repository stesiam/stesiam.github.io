{
  "hash": "a92818c872d6fb621cbbacf0387c74b0",
  "result": {
    "markdown": "---\ntitle: \"Statistics of Statistics Graduates\"\nauthor: \"stesiam\"\ndescription: |\n  Extracting tabular data from PDF file, in order to explore facts about graduates of Statistics and Insurance Department in University of Piraeus\nlink-external-newwindow: true\ncategories: [R, EDA, PDF, tabulizer]\nfig-cap-location: bottom\ndate: \"2023-07-23\"\nfreeze: true\nimage: graduation-cap.jpg\ndf_print: paged\nimage-alt: graduation cap\ntoc: true\ntoc-title: Table of contents\ntoc-location: left\ncitation: true\nslug: stesiam2022\ntitle-block-banner: true\nnocite: '@*'\ncsl: apa-6th-edition\nbibliography: [packages.bib, references.bib]\nformat: \n  html:\n    code-link: true\n    code-fold: false\n    code-summary: \"Show the code\"\n    code-tools: \n      source: repo\nexecute:\n  echo: true\neditor_options: \n  markdown: \n    wrap: 80\n---\n\n\n\n\n\n## Introduction\n\nStatistics can be hard. This is \n\nTHe recent study guide includes data about the graduates and their average grade of graduation over the years. First and foremost the data we are interested in are included in table form (which is good) but is is part of a pdf file (which is not good :)). Thankfully, **tabulizer** is the solution to this kind of problems.\n\n\n\n## Load Packages\n\nAs I will extract tables from a pdf file, I will definitely need **tabulizer** package. Unfortunately, I was not able to install the specific package, as I was getting an error similar to this [one](https://github.com/ropensci/tabulizer/issues/157). This issue seems to be related to rJava package and [this comment](https://github.com/s-u/rJava/issues/255#issuecomment-794473988) solved the issue. After installing rJava I was able to install successufully tabulizer as below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# remotes::install_github(c(\"ropensci/tabulizerjars\", \"ropensci/tabulizer\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rJava)\nlibrary(tabulizer)\nlibrary(dplyr)\nlibrary(pdftools)\nlibrary(tidyr)\nlibrary(reactable)\n\nlibrary(ggplot2)\nlibrary(ggtext)\n```\n:::\n\n\n\n\n## Extract Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# url = \"https://www.unipi.gr/faculty/mbouts/anak/OS_22_23.pdf\"\n# \n# download.file(url, \n#               destfile = \"sg22.pdf\",\n#               method = \"wget\",\n#               extra = \"--no-check-certificate\")\n\npdf_subset('sg22.pdf',\n  pages = 186:190,  output = \"subset.pdf\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"/home/stelios/Desktop/stesiam/english/2023-07-23-Graduates-of-Statistics/subset.pdf\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstatistics_tables <- extract_tables(\n    file   = \"subset.pdf\", \n    method = \"decide\", \n    output = \"data.frame\")\n```\n:::\n\n\n## Analysing Data\n\n###  Admitted students\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadmitted_students = statistics_tables[[1]] %>%\n  .[-1,] %>%\n  setNames(c(\"Year\", \"Main_exams\", \"Transfer\", \"Entry_exams\", \"Other\", \"Total\"))\n\nadmitted_students$Main_exams = admitted_students$Main_exams %>% as.integer()\nadmitted_students$Transfer= admitted_students$Transfer %>% as.integer()\nadmitted_students$Entry_exams = admitted_students$Entry_exams %>% as.integer()\nadmitted_students$Other = admitted_students$Other %>% as.integer()\n\nrownames(admitted_students) = 1:nrow(admitted_students)\n\nadmitted_students = admitted_students %>% \n  pivot_longer(\n    cols = !Year, \n    names_to = \"Admission_Type\", \n    values_to = \"count\"\n  )\n\nadmitted_students %>%\n  reactable(\n    defaultPageSize = 5\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"reactable html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-b4133ecfd9081fe1888a\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b4133ecfd9081fe1888a\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Year\":[\"2003-2004\",\"2003-2004\",\"2003-2004\",\"2003-2004\",\"2003-2004\",\"2004-2005\",\"2004-2005\",\"2004-2005\",\"2004-2005\",\"2004-2005\",\"2005-2006\",\"2005-2006\",\"2005-2006\",\"2005-2006\",\"2005-2006\",\"2006-2007\",\"2006-2007\",\"2006-2007\",\"2006-2007\",\"2006-2007\",\"2007-2008\",\"2007-2008\",\"2007-2008\",\"2007-2008\",\"2007-2008\",\"2008-2009\",\"2008-2009\",\"2008-2009\",\"2008-2009\",\"2008-2009\",\"2009-2010\",\"2009-2010\",\"2009-2010\",\"2009-2010\",\"2009-2010\",\"2010-2011\",\"2010-2011\",\"2010-2011\",\"2010-2011\",\"2010-2011\",\"2011-2012\",\"2011-2012\",\"2011-2012\",\"2011-2012\",\"2011-2012\",\"2012-2013\",\"2012-2013\",\"2012-2013\",\"2012-2013\",\"2012-2013\",\"2013-2014\",\"2013-2014\",\"2013-2014\",\"2013-2014\",\"2013-2014\",\"2014-2015\",\"2014-2015\",\"2014-2015\",\"2014-2015\",\"2014-2015\",\"2015-2016\",\"2015-2016\",\"2015-2016\",\"2015-2016\",\"2015-2016\",\"2016-2017\",\"2016-2017\",\"2016-2017\",\"2016-2017\",\"2016-2017\",\"2017-2018\",\"2017-2018\",\"2017-2018\",\"2017-2018\",\"2017-2018\",\"2018-2019\",\"2018-2019\",\"2018-2019\",\"2018-2019\",\"2018-2019\",\"2019-2020\",\"2019-2020\",\"2019-2020\",\"2019-2020\",\"2019-2020\",\"2020-2121\",\"2020-2121\",\"2020-2121\",\"2020-2121\",\"2020-2121\",\"2021-2022\",\"2021-2022\",\"2021-2022\",\"2021-2022\",\"2021-2022\",\"2022-2023\",\"2022-2023\",\"2022-2023\",\"2022-2023\",\"2022-2023\"],\"Admission_Type\":[\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\",\"Main_exams\",\"Transfer\",\"Entry_exams\",\"Other\",\"Total\"],\"count\":[183,15,1,17,216,181,21,1,16,219,186,11,1,16,214,186,27,1,9,223,185,38,2,18,243,170,44,1,12,253,170,60,0,14,244,175,47,4,24,250,198,0,0,3,201,206,14,2,15,237,205,20,2,48,275,219,48,1,4,272,212,29,1,4,246,212,30,4,0,246,209,41,1,1,252,189,11,1,5,206,228,55,2,7,292,234,-16,1,5,224,134,\"NA\",\"NA\",1,133,168,\"NA\",\"NA\",3,170]},\"columns\":[{\"id\":\"Year\",\"name\":\"Year\",\"type\":\"character\"},{\"id\":\"Admission_Type\",\"name\":\"Admission_Type\",\"type\":\"character\"},{\"id\":\"count\",\"name\":\"count\",\"type\":\"numeric\"}],\"defaultPageSize\":5,\"dataKey\":\"013676f9c2d732827646d87a9d894ddf\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nadmitted_students %>%\n  filter(Admission_Type %in% c(\"Main_exams\", \"Total\")) %>%\n  ggplot2::ggplot(., aes(x = Year, y = count, color = Admission_Type , group = Admission_Type)) +\n  geom_line() +\n  geom_point() +\n  labs(\n    title = \"Admitted students\",\n    subtitle = \"Admitted students over the years (2003-2023) at Department of Statistics and Insurance Science of <br> University of Piraeus. A significant drop in admissions occured in 2021 which is maily caused by the <br> introduction of grade requirements to be admitted to specific departments.\",\n    caption = \"stesiam, 2023\",\n    x = \"Academic Year\",\n    y = \"Students\",\n    color = \"Type of Admission\"\n  ) +\n  theme_classic() +\n  theme(\n    plot.title = element_markdown(family = \"serif\", face=\"bold\"),\n    plot.subtitle = element_markdown(family = \"serif\"),\n    plot.caption = element_markdown(family = \"serif\"),\n    axis.text.x = element_text(face=\"bold\", angle=90)\n  )\n```\n\n::: {.cell-output-display}\n![](2023-07-23-Graduates-of-Statistics_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Master Programmes\n\n\n\nDepartment of Statistics and Isurance Science has 2 master programs \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsc_students = statistics_tables[[2]] %>%\n  setNames(c(\"AcademicYear\", \"BSc\", \"MSc (AppliedStat)\", \"MSc (Actuar)\", \"PhD\")) %>%\n  .[-1,]\n\nrownames(msc_students) = 1:nrow(msc_students)\n\nmsc_students = msc_students %>%\n  mutate_at(c(\"BSc\", \"MSc (AppliedStat)\", \"MSc (Actuar)\", \"PhD\"), as.numeric) %>%\n  mutate(pct = round((PhD/BSc)*100, 2))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nâ„¹ In argument: `MSc (Actuar) = .Primitive(\"as.double\")(`MSc (Actuar)`)`.\nCaused by warning:\n! NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\nmsc_students %>%\n  reactable(\n    defaultPageSize = 5\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"reactable html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-05253819465d35270efe\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-05253819465d35270efe\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"AcademicYear\":[\"2003-2004\",\"2004-2005\",\"2005-2006\",\"2006-2007\",\"2007-2008\",\"2008-2009\",\"2009-2010\",\"2010-2011\",\"2011-2012\",\"2012-2013\",\"2013-2014\",\"2014-2015\",\"2015-2016\",\"2016-2017\",\"2017-2018\",\"2018-2019\",\"2019-2020\",\"2020-2021\",\"2021-2022\",\"2022-2023\"],\"BSc\":[2135,2128,2225,2255,2360,2411,2429,2629,2528,2631,2707,2656,2742,2842,2953,3021,3091,3200,3159,3177],\"MSc (AppliedStat)\":[68,67,89,57,65,50,54,55,56,52,56,52,85,42,47,43,53,66,102,111],\"MSc (Actuar)\":[\"NA\",\"NA\",\"NA\",\"NA\",38,66,81,86,88,87,89,110,47,74,85,69,68,66,93,85],\"PhD\":[11,16,20,24,24,20,13,13,16,15,16,14,14,18,21,21,19,19,18,15],\"pct\":[0.52,0.75,0.9,1.06,1.02,0.83,0.54,0.49,0.63,0.57,0.59,0.53,0.51,0.63,0.71,0.7,0.61,0.59,0.57,0.47]},\"columns\":[{\"id\":\"AcademicYear\",\"name\":\"AcademicYear\",\"type\":\"character\"},{\"id\":\"BSc\",\"name\":\"BSc\",\"type\":\"numeric\"},{\"id\":\"MSc (AppliedStat)\",\"name\":\"MSc (AppliedStat)\",\"type\":\"numeric\"},{\"id\":\"MSc (Actuar)\",\"name\":\"MSc (Actuar)\",\"type\":\"numeric\"},{\"id\":\"PhD\",\"name\":\"PhD\",\"type\":\"numeric\"},{\"id\":\"pct\",\"name\":\"pct\",\"type\":\"numeric\"}],\"defaultPageSize\":5,\"dataKey\":\"9e1a659e4b3bbf409916a76f20fe3050\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(msc_students, aes(x = AcademicYear, y = pct, group = 1)) +\n  geom_line() +\n  labs(\n    title = \"Ratio of PhD students/ Undergraduates\",\n    subtitle = \"The decrease \",\n    caption = \"stesiam, 2023\"\n  ) +\n  theme_classic() +\n  theme(\n    plot.title = element_markdown(family = \"serif\", face=\"bold\"),\n    plot.subtitle = element_markdown(family = \"serif\"),\n    plot.caption = element_markdown(family = \"serif\"),\n    axis.text.x = element_text(face=\"bold\", angle=90)\n  )\n```\n\n::: {.cell-output-display}\n![](2023-07-23-Graduates-of-Statistics_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_students = msc_students %>%\n  select(!pct) %>%\n  tidyr::pivot_longer(., cols = !c(AcademicYear), values_to = \"count\")\n\nggplot(tidy_students, aes(x = AcademicYear, y = count, fill = name)) +\n  geom_col() +\n  guides(fill = guide_legend(reverse = TRUE)) +\n  labs(\n    title = \"Ratio of PhD students/ Undergraduates\",\n    subtitle = \"The decrease \",\n    caption = \"stesiam, 2023\",\n    x = \"\",\n    y = \"\"\n  ) +\n  theme_classic() +\n  theme(\n    plot.title = element_markdown(family = \"serif\", face=\"bold\"),\n    plot.subtitle = element_markdown(family = \"serif\"),\n    plot.caption = element_markdown(family = \"serif\"),\n    axis.text.x = element_text(face=\"bold\", angle=90)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing missing values (position_stack).\n```\n:::\n\n::: {.cell-output-display}\n![](2023-07-23-Graduates-of-Statistics_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n## MSc Students\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatistics_tables[[3]] %>%\n  select(c(1,2)) %>%\n  setNames(c(\"Year\", \"S\")) %>%\n  .[-c(1,2),] %>%\n  separate(S, c('Admitted', 'Graduated')) %>%\n  na.omit()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expected 2 pieces. Missing pieces filled with `NA` in 21 rows [1, 3,\n5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, ...].\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n        Year Admitted Graduated\n4  2003-2004       27        15\n6  2004-2005       28        26\n8  2005-2006       25        20\n10 2006-2007       25        34\n12 2007-2008       24        31\n14 2008-2009       20        42\n16 2009-2010       30        27\n18 2010-2011       20        17\n20 2011-2012       30        26\n22 2012-2013       18        19\n24 2013-2014       23        35\n26 2014-2015       20        29\n28 2015-2016       21        24\n30 2016-2017       20        22\n32 2017-2018       23        21\n34 2018-2019       22        20\n36 2019-2020       26        15\n38 2020-2021       32        18\n40 2021-2022       41        33\n```\n:::\n:::\n\n\n\n\n## Acknowledgements {.appendix .unlisted}\n\nDataset based on recent study guide <a href=\"https://www.unipi.gr/faculty/mbouts/anak/OS_22_23.pdf\">recent study guide</a> of Department of Statistics and Insurance Science of the University of Piraeus.\n\nImage by <a href=\"https://pixabay.com/users/vloveland-4834409/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2148715\">Victoria Loveland</a> from <a href=\"https://pixabay.com//?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2148715\">Pixabay</a>\n\n\n## References {.appendix .unlisted}",
    "supporting": [
      "2023-07-23-Graduates-of-Statistics_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"../../site_libs/react-17.0.0/react.min.js\"></script>\n<script src=\"../../site_libs/react-17.0.0/react-dom.min.js\"></script>\n<script src=\"../../site_libs/reactwidget-1.0.0/react-tools.js\"></script>\n<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}