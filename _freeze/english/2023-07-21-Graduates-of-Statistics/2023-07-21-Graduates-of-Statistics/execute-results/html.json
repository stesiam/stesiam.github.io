{
  "hash": "603871fec6b2ba9913e75b919ae4dfa5",
  "result": {
    "markdown": "---\ntitle: \"Statistics of Statistics Graduates\"\nauthor: \"stesiam\"\ndescription: |\n  Extracting tabular data from PDF file, in order to explore facts about graduates of Statistics and Insurance Department in University of Piraeus\nlink-external-newwindow: true\ncategories: [R, EDA, PDF, tabulizer]\nfig-cap-location: bottom\ndate: \"2023-07-21\"\nfreeze: true\nimage: graduation-cap.jpg\ndf_print: paged\nimage-alt: graduation cap\ntoc: true\ntoc-title: Table of contents\ntoc-location: left\ncitation: true\nslug: stesiam2022\ntitle-block-banner: true\nnocite: '@*'\ncsl: apa-6th-edition\nbibliography: [packages.bib, references.bib]\nformat: \n  html:\n    code-link: true\n    code-fold: false\n    code-summary: \"Show the code\"\n    code-tools: \n      source: repo\nexecute:\n  echo: true\neditor_options: \n  markdown: \n    wrap: 80\n---\n\n\n\n\n\n## Introduction\n\nStatistics can be hard. This is \n\nTHe recent study guide includes data about the graduates and their average grade of graduation over the years. First and foremost the data we are interested in are included in table form (which is good) but is is part of a pdf file (which is not good :)). Thankfully, **tabulizer** is the solution to this kind of problems.\n\n\n\n## Load Packages\n\nAs I will extract tables from a pdf file, I will definitely need **tabulizer** package. Unfortunately, I was not able to install the specific package, as I was getting an error similar to this [one](https://github.com/ropensci/tabulizer/issues/157). This issue seems to be related to rJava package and [this comment](https://github.com/s-u/rJava/issues/255#issuecomment-794473988) solved the issue. After installing rJava I was able to install successufully tabulizer as below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# remotes::install_github(c(\"ropensci/tabulizerjars\", \"ropensci/tabulizer\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rJava)\nlibrary(tabulizer)\nlibrary(dplyr)\nlibrary(pdftools)\nlibrary(tidyr)\n```\n:::\n\n\n\n\n## Extract Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl = \"https://www.unipi.gr/faculty/mbouts/anak/OS_22_23.pdf\"\n\ndownload.file(url, \n              destfile = \"sg22.pdf\",\n              method = \"wget\",\n              extra = \"--no-check-certificate\")\n\npdf_subset('sg22.pdf',\n  pages = 186:190,  output = \"subset.pdf\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"/home/stelios/Desktop/stesiam/english/2023-07-21-Graduates-of-Statistics/subset.pdf\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstatistics_tables <- extract_tables(\n    file   = \"subset.pdf\", \n    method = \"decide\", \n    output = \"data.frame\")\n```\n:::\n\n\n## Analysing Data\n\n###  Admitted students\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadmitted_students = statistics_tables[[1]] %>%\n  .[-1,] %>%\n  setNames(c(\"Year\", \"Main_exams\", \"Transfer\", \"Entry_exams\", \"Other\", \"Total\"))\n\nadmitted_students$Main_exams = admitted_students$Main_exams %>% as.integer()\nadmitted_students$Transfer= admitted_students$Transfer %>% as.integer()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in admitted_students$Transfer %>% as.integer(): NAs introduced by\ncoercion\n```\n:::\n\n```{.r .cell-code}\nadmitted_students$Entry_exams = admitted_students$Entry_exams %>% as.integer()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in admitted_students$Entry_exams %>% as.integer(): NAs introduced by\ncoercion\n```\n:::\n\n```{.r .cell-code}\nadmitted_students$Other = admitted_students$Other %>% as.integer()\n\nrownames(admitted_students) = 1:nrow(admitted_students)\n\nadmitted_students %>% \n  pivot_longer(\n    cols = !Year, \n    names_to = \"Admission_Type\", \n    values_to = \"count\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 100 × 3\n   Year      Admission_Type count\n   <chr>     <chr>          <int>\n 1 2003-2004 Main_exams       183\n 2 2003-2004 Transfer          15\n 3 2003-2004 Entry_exams        1\n 4 2003-2004 Other             17\n 5 2003-2004 Total            216\n 6 2004-2005 Main_exams       181\n 7 2004-2005 Transfer          21\n 8 2004-2005 Entry_exams        1\n 9 2004-2005 Other             16\n10 2004-2005 Total            219\n# ℹ 90 more rows\n```\n:::\n:::\n\n\n\n\n\n\n\n\n## Acknowledgements {.appendix .unlisted}\n\nDataset based on recent study guide <a href=\"https://www.unipi.gr/faculty/mbouts/anak/OS_22_23.pdf\">recent study guide</a> of Department of Statistics and Insurance Science of the University of Piraeus.\n\nImage by <a href=\"https://pixabay.com/users/vloveland-4834409/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2148715\">Victoria Loveland</a> from <a href=\"https://pixabay.com//?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2148715\">Pixabay</a>\n\n\n## References {.appendix .unlisted}",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}