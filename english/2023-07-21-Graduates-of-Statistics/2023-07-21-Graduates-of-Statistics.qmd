---
title: "Statistics of Statistics Graduates"
author: "stesiam"
description: |
  Extracting tabular data from PDF file, in order to explore facts about graduates of Statistics and Insurance Department in University of Piraeus
link-external-newwindow: true
categories: [R, EDA, PDF, tabulizer]
fig-cap-location: bottom
date: "2023-07-21"
freeze: true
image: graduation-cap.jpg
df_print: paged
image-alt: graduation cap
toc: true
toc-title: Table of contents
toc-location: left
citation: true
slug: stesiam2022
title-block-banner: true
nocite: '@*'
csl: apa-6th-edition
bibliography: [packages.bib, references.bib]
format: 
  html:
    code-link: true
    code-fold: false
    code-summary: "Show the code"
    code-tools: 
      source: repo
execute:
  echo: true
editor_options: 
  markdown: 
    wrap: 80
---

```{r, include=FALSE}
here::here("english/2023-07-21-Graduates-of-Statistics")
```


## Introduction

Statistics can be hard. This is 

THe recent study guide includes data about the graduates and their average grade of graduation over the years. First and foremost the data we are interested in are included in table form (which is good) but is is part of a pdf file (which is not good :)). Thankfully, **tabulizer** is the solution to this kind of problems.



## Load Packages

As I will extract tables from a pdf file, I will definitely need **tabulizer** package. Unfortunately, I was not able to install the specific package, as I was getting an error similar to this [one](https://github.com/ropensci/tabulizer/issues/157). This issue seems to be related to rJava package and [this comment](https://github.com/s-u/rJava/issues/255#issuecomment-794473988) solved the issue. After installing rJava I was able to install successufully tabulizer as below:

```{r}
# remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"))
```



```{r Import R libraries, warning=F, message=FALSE}
library(rJava)
library(tabulizer)
library(dplyr)
library(pdftools)
library(tidyr)
```


```{r Add references of R libraries, include=FALSE}
# Add loaded libraries to bibliography section

knitr::write_bib(.packages(), file = 'packages.bib')
```

## Extract Data



```{r}
url = "https://www.unipi.gr/faculty/mbouts/anak/OS_22_23.pdf"

download.file(url, 
              destfile = "sg22.pdf",
              method = "wget",
              extra = "--no-check-certificate")

pdf_subset('sg22.pdf',
  pages = 186:190,  output = "subset.pdf")

```

```{r}
statistics_tables <- extract_tables(
    file   = "subset.pdf", 
    method = "decide", 
    output = "data.frame")
```

## Analysing Data

###  Admitted students

```{r}
admitted_students = statistics_tables[[1]] %>%
  .[-1,] %>%
  setNames(c("Year", "Main_exams", "Transfer", "Entry_exams", "Other", "Total"))

admitted_students$Main_exams = admitted_students$Main_exams %>% as.integer()
admitted_students$Transfer= admitted_students$Transfer %>% as.integer()
admitted_students$Entry_exams = admitted_students$Entry_exams %>% as.integer()
admitted_students$Other = admitted_students$Other %>% as.integer()

rownames(admitted_students) = 1:nrow(admitted_students)

admitted_students %>% 
  pivot_longer(
    cols = !Year, 
    names_to = "Admission_Type", 
    values_to = "count"
  )
```







## Acknowledgements {.appendix .unlisted}

Dataset based on recent study guide <a href="https://www.unipi.gr/faculty/mbouts/anak/OS_22_23.pdf">recent study guide</a> of Department of Statistics and Insurance Science of the University of Piraeus.

Image by <a href="https://pixabay.com/users/vloveland-4834409/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2148715">Victoria Loveland</a> from <a href="https://pixabay.com//?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2148715">Pixabay</a>


## References {.appendix .unlisted}